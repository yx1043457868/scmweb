webpackJsonp([39],{QUDO:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});s("34+y");var a=s("X+yh"),o=s.n(a),n=(s("OgVB"),s("/Lyv")),i=s.n(n),r={name:"orderList",components:{MescrollVue:s("p0f0").a},data:function(){return{searchText:"",search:!1,mescroll:null,mescrollDown:{},mescrollUp:{callback:this.upCallback,page:{num:0,size:10},htmlNodata:'<p class="upwarp-nodata">-- 没有更多了 --</p>',noMoreSize:5,empty:{warpId:"mescroll",icon:"static/images/none.png",tip:"暂无相关数据~"}},classId:this.$route.query.typeId||"",payStatus:this.$route.query.payStatus||"",currentIndex:0,popupVisible:!1,dataList:[{name:"全部",value:""},{name:"待预付",value:"1"},{name:"待接单",value:"2"},{name:"配送中",value:"3,4,5,6"},{name:"已收货",value:"7"},{name:"已取消",value:"99"}],orderList:[]}},beforeRouteEnter:function(t,e,s){s(function(t){t.$refs.mescroll.beforeRouteEnter()})},beforeRouteLeave:function(t,e,s){this.$refs.mescroll.beforeRouteLeave(),s()},watch:{popupVisible:function(t){t?this.closeTouch():this.openTouch()}},computed:{orderTitle:function(){return""==this.classId&&""==this.payStatus?"全部预订单":"1"==this.classId?"待预付":"2"==this.classId?"待接单":"3,4,5,6"==this.classId?"配送中订单":"7"==this.classId?"已收货订单":"99"==this.classId?"已取消订单":void 0}},methods:{hide:function(){this.search=!1},back:function(){if(window.history.length<=1)return this.$router.push({path:"/"}),!1;this.$router.push({path:"/userCenter"})},mescrollInit:function(t){this.mescroll=t},upCallback:function(t,e){var s=this,a=this.$store.getters.account,o='{"shopId":"'+a.shopId+'","companyId":"'+a.companyId+'","handleStatus": "'+this.classId+'","pageSize": "'+t.size+'","page": "'+t.num+'"}';this.$post("/appPreOrder/selectAppPreorderList.do",{content:o,version:"kkllo",login_token:this.$store.getters.logintoken}).then(function(a){var o=JSON.parse(a).res.list;1===t.num&&(s.orderList=[]),s.orderList=s.orderList.concat(o),s.$nextTick(function(){e.endSuccess(o.length)})}).catch(function(t){e.endErr()})},chosen:function(t,e){this.currentIndex=t,"nopay"==e?(this.classId="",this.payStatus="2"):"pay"==e?(this.classId="",this.payStatus="1"):(this.classId=e,this.payStatus="")},reset:function(){this.currentIndex=0,this.classId="",this.payStatus="",this.searchText=""},sureOrder:function(t,e){var s=this;i.a.confirm("确定签收吗?").then(function(a){var n=s.$store.getters.account.account,i="{'orderCode':'"+t+"','account':'"+n+"'}";s.$post("/appVpOrder/receiveOrderBySale.do",{content:i,version:"kkllo",login_token:s.$store.getters.logintoken}).then(function(t){var a=JSON.parse(t);"yes"==a.optFlag?(""!=s.classId?s.orderList.splice(e,1):s.orderList[e].handleStatus=4,o()(a.optDesc)):o()(a.optDesc)})}).catch(function(){})},comfirm:function(){this.popupVisible=!1,this.mescroll.resetUpScroll()},handleSearch:function(t){this.search=!1,this.searchText=t,this.comfirm()},closeTouch:function(){document.getElementsByTagName("body")[0].addEventListener("touchmove",this.handler,{passive:!1})},openTouch:function(){document.getElementsByTagName("body")[0].removeEventListener("touchmove",this.handler,{passive:!1})},cancelOrder:function(t,e,s){var a=this;i.a.confirm("确定取消该订单吗?").then(function(n){var i=a.$store.getters.account.account,r="{'id':'"+t+"','handleStatus':'99','orderCode':'"+e+"','account':'"+i+"'}";a.$post("/appPreOrder/updateAppPreorder.do",{content:r,version:"kkllo",login_token:a.$store.getters.logintoken}).then(function(t){var e=JSON.parse(t);"yes"==e.optFlag?(""!=a.classId?a.orderList.splice(s,1):a.orderList[s].handleStatus=99,o()(e.optDesc)):o()(e.optDesc)})}).catch(function(){})},confirmReceipt:function(t,e){var s=this;i.a.confirm("确定收货吗?").then(function(a){var n=s.$store.getters.account.account,i="{'id':'"+t+"','account':'"+n+"'}";s.$post("/appPreOrder/confirmReceipt.do",{content:i,version:"kkllo",login_token:s.$store.getters.logintoken}).then(function(t){var a=JSON.parse(t);"yes"==a.optFlag?(""!=s.classId?s.orderList.splice(e,1):s.orderList[e].handleStatus=7,o()(a.optDesc)):o()(a.optDesc)})}).catch(function(){})}}},c={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("div",{staticClass:"header"},[s("mt-header",{attrs:{title:t.orderTitle}},[s("mt-button",{attrs:{slot:"left",icon:"back"},on:{click:t.back},slot:"left"}),t._v(" "),s("mt-button",{attrs:{slot:"right",icon:""},on:{click:function(e){t.popupVisible=!0}},slot:"right"},[s("i",{staticClass:"iconfont",staticStyle:{"font-size":"24px"}},[t._v("")])])],1)],1),t._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:t.popupVisible,expression:"popupVisible"}],staticClass:"mint-popup right-popup mint-popup-right",on:{click:function(e){t.popupVisible=!1}}}),t._v(" "),s("transition",{attrs:{name:"slide","enter-active-class":"animated slideInRight","leave-active-class":"animated slideOutRight"}},[s("div",{directives:[{name:"show",rawName:"v-show",value:t.popupVisible,expression:"popupVisible"}],staticClass:"popup-model"},[s("div",{staticClass:"model-wrap"},[s("div",{staticClass:"model-content"},[s("h5",{staticClass:"model-t"},[s("span",[t._v("订单状态")])]),t._v(" "),s("div",{staticClass:"model-item"},t._l(t.dataList,function(e,a){return s("button",{key:a,class:{active:t.currentIndex===a},on:{click:function(s){t.chosen(a,e.value)}}},[t._v(t._s(e.name))])}),0)])]),t._v(" "),s("div",{staticClass:"handle-btn"},[s("button",{staticClass:"comfirm",on:{click:t.comfirm}},[t._v("确定")])])])]),t._v(" "),s("mescroll-vue",{ref:"mescroll",attrs:{down:t.mescrollDown,up:t.mescrollUp},on:{init:t.mescrollInit}},[s("div",{attrs:{id:"mescroll"}},[s("div",{staticClass:"order-wrapper"},[s("ul",t._l(t.orderList,function(e,a){return s("li",{key:a,staticClass:"order-list"},[s("div",{staticClass:"list-h clearfix"},[s("span",{staticClass:"mui-pull-left",staticStyle:{"font-weight":"500"}},[s("span",{staticClass:"iconfont def"},[t._v("")]),t._v(t._s(e.orderCode))]),t._v(" "),s("span",{staticClass:"orderSt mui-pull-right"},[1==e.handleStatus?s("em",{staticClass:"blue"},[t._v("待预付")]):2==e.handleStatus?s("em",{staticClass:"blue"},[t._v("待接单")]):3==e.handleStatus||4==e.handleStatus||5==e.handleStatus||6==e.handleStatus?s("em",{staticClass:"blue"},[t._v("配送中")]):7==e.handleStatus?s("em",{staticClass:"blue"},[t._v("已收货")]):99==e.handleStatus?s("em",{staticClass:"gray"},[t._v("已取消")]):t._e()])]),t._v(" "),s("div",{staticClass:"order-info clearfix"},[s("p",{staticClass:"order-title"},[t._v("采购品类："+t._s(e.sumQty))]),t._v(" "),s("p",{staticClass:"order-title"},[t._v("采购时间："+t._s(t._f("formatTime")(e.createTime)))]),t._v(" "),"1"==e.payStatus?s("p",{staticClass:"order-title"},[t._v("支付状态："),s("span",{staticStyle:{color:"#000"}},[t._v("已支付")])]):"2"==e.payStatus?s("p",{staticClass:"order-title"},[t._v("支付状态："),s("span",{staticStyle:{color:"red"}},[t._v("定金未支付")])]):"3"==e.payStatus?s("p",{staticClass:"order-title"},[t._v("支付状态："),s("span",{staticStyle:{color:"red"}},[t._v("尾款未支付")])]):t._e(),t._v(" "),s("p",{staticClass:"order-title clearfix"},[s("span",{staticClass:"order-n"},[t._v("订单金额：￥"+t._s(t._f("formatMoney")(e.sumAmount)))]),t._v(" "),"2"==e.payStatus?s("span",{staticClass:"order-t"},[t._v("预付定金：￥"+t._s(t._f("formatMoney")(e.preAmount)))]):"3"==e.payStatus?s("span",{staticClass:"order-t"},[t._v("应付尾款：￥"+t._s(t._f("formatMoney")(e.tailAmount)))]):s("span",{staticClass:"order-t"})])]),t._v(" "),s("div",{staticClass:"list-b clearfix"},[s("router-link",{staticClass:"mui-btn",attrs:{to:{path:"/orderDetail",query:{id:e.orderCode}},tag:"button"}},[t._v("\n                                查看详情\n                            ")]),t._v(" "),1==e.handleStatus?s("button",{staticClass:"mui-btn",on:{click:function(s){t.cancelOrder(e.id,e.orderCode,a)}}},[t._v("\n                                取消订单\n                            ")]):t._e(),t._v(" "),3==e.handleStatus||4==e.handleStatus||5==e.handleStatus||6==e.handleStatus?s("button",{staticClass:"mui-btn",on:{click:function(s){t.confirmReceipt(e.id,a)}}},[t._v("\n                                确认收货\n                            ")]):t._e(),t._v(" "),"1"==e.handleStatus&&"2"==e.payStatus?s("router-link",{staticClass:"mui-btn",attrs:{to:{path:"/prePay",query:{orderCode:e.orderCode}},tag:"button"}},[t._v("\n                                支付定金\n                            ")]):t._e(),t._v(" "),"1"!=e.handleStatus&&"99"!=e.handleStatus&&"3"==e.payStatus?s("router-link",{staticClass:"mui-btn",attrs:{to:{path:"/prePay",query:{orderCode:e.orderCode}},tag:"button"}},[t._v("\n                                支付尾款\n                            ")]):t._e()],1)])}),0)])])])],1)},staticRenderFns:[]};var l=s("VU/8")(r,c,!1,function(t){s("T9EO")},"data-v-66743b7f",null);e.default=l.exports},T9EO:function(t,e){}});