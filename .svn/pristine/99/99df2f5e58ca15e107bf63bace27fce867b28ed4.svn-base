webpackJsonp([58],{"9yoW":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});a("OgVB");var s=a("/Lyv"),i=a.n(s),c=a("mvHQ"),r=a.n(c),l=(a("34+y"),a("X+yh")),o=a.n(l),n=a("fZjL"),u=a.n(n),d=a("teIl"),v=a("0xDb"),m={name:"returngood",components:{Header:d.a},data:function(){return{goods:"",searchKey:"",isShow:!0,orderList:[],note:""}},filters:{capitalize:function(e,t,a,s){if(1==t)return parseFloat(e).toFixed(2)+""+a;var i=Object(v.m)(parseFloat(e)||0,parseFloat(t)||1),c=parseInt(parseFloat(e)/parseFloat(t));return 0==i?c.toFixed(2)+""+a:0==c?i+""+s:c+""+a+i+s}},computed:{checkedLen:function(){return this.orderList.filter(function(e){return e.checked}).length},outOrderList:{get:function(){return this.orderList.filter(function(e){return 1==e.checked})},set:function(){}},searchData:function(){var e=this.searchKey;return e?this.orderList.filter(function(t){return u()(t).some(function(a){return String(t[a]).toLowerCase().indexOf(e)>-1})}):this.products}},created:function(){this.orderDetailForSale()},watch:{ProductClass:function(e,t){this.ProductClass.length>0&&0==this.currentIndex&&(this.classId=this.ProductClass[0].id)}},methods:{changeValue:function(e,t,a){Object(v.j)(Object(v.l)(parseFloat(e.value),e.equation_factor),parseFloat(e.mnum_value)||0)>e.qty&&(o()("退货数量不能大于请货量"),e.value=a.target.value,e.mnum_value=0),e.must_amount=Object(v.j)(Object(v.l)(parseFloat(e.value)||0,e.unit_price),Object(v.l)(parseFloat(e.mnum_value)||0,e.price))},changeMnumValue:function(e,t,a){Object(v.j)(Object(v.l)(parseFloat(e.value),e.equation_factor),parseFloat(e.mnum_value)||0)>e.qty&&(o()("退货数量不能大于请货量"),a.target.value=0,e.value=0,e.mnum_value=a.target.value),e.must_amount=Object(v.j)(Object(v.l)(parseFloat(e.value)||0,e.unit_price),Object(v.l)(parseFloat(e.mnum_value)||0,e.price))},orderDetailForSale:function(){var e=this;this.$post("/appVpOrder/orderDetailForSale.do",{content:'{"orderCode":"'+this.$route.query.orderCode+'"}',version:"kkllo",login_token:this.$store.getters.logintoken}).then(function(t){var a=JSON.parse(t);"yes"==a.optFlag?(a.res.skuList.forEach(function(e){e.checked=!1,e.untcg=""}),e.orderList=a.res.skuList,e.order=a.res.order):o()("商品加载失败")})},submit:function(){if(0==this.checkedLen)return o()({message:"请选择需要退货的商品",duration:1e3}),!1;this.outOrderList.map(function(e){if(1==e.equation_factor)e.value=parseFloat(e.realSendQty);else{var t=Object(v.m)(parseFloat(e.realSendQty)||0,parseFloat(e.equation_factor)||1),a=parseInt(parseFloat(e.realSendQty)/parseFloat(e.equation_factor));e.value=a,e.mnum_value=t}e.totalPrice=Object(v.j)(Object(v.l)(parseFloat(e.value),e.unit_price),Object(v.l)(parseFloat(e.mnum_value),e.price))}),this.isShow=!1},submitOrder:function(){var e=this,t={},a=[];this.outOrderList.forEach(function(e){t={returnQty:Object(v.j)(Object(v.l)(parseFloat(e.value)||0,e.equation_factor||1),parseFloat(e.mnum_value)||0),price:e.price,equationFactor:e.equation_factor,styleno:e.styleno,skuCode:e.skuCode,skuName:e.skuName,uomDefault:e.uom_default,unit:e.unit},a.push(t)});var s={account:this.$store.getters.account.account,companyId:this.$store.getters.account.companyId,orderCode:this.$route.query.orderCode,sendWmcode:this.$route.query.wmcode?this.$route.query.wmcode:this.outOrderList[0].send_wm_code,note:this.note,skuJson:a};this.$post("/returnorder/saveReturnOrder.do",{content:r()(s),version:"kkllo",login_token:this.$store.getters.logintoken}).then(function(t){var a=JSON.parse(t);a.optFlag,i.a.alert(a.optDesc).then(function(t){e.$router.go(-1)})})}}},_={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{directives:[{name:"show",rawName:"v-show",value:e.isShow,expression:"isShow"}]},[a("Header",{attrs:{title:"退货"}}),e._v(" "),a("div",{staticClass:"top-bar clearfix"},[a("div",{staticClass:"top-bar-box"},[a("div",{staticClass:"top_search  mui-pull-left"},[a("span",{staticClass:"search-icon iconfont"},[e._v("")]),e._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:e.searchKey,expression:"searchKey"}],staticClass:"mui-pull-left",attrs:{type:"search",placeholder:"请输入商品名称/商品id/关键字",id:"search_input"},domProps:{value:e.searchKey},on:{input:function(t){t.target.composing||(e.searchKey=t.target.value)}}}),e._v(" "),a("button",{staticClass:"search_btn",on:{click:function(t){e.search(e.searchKey)}}})])])]),e._v(" "),a("div",{staticClass:"form-wrapper"},[a("div",{staticClass:"not-title"},[e._v("请选择需要退货的商品")]),e._v(" "),a("ul",{directives:[{name:"show",rawName:"v-show",value:""==e.searchKey,expression:"searchKey == ''"}],staticClass:"mui-table-view order-ul bg-write"},e._l(e.orderList,function(t,s){return a("li",{key:s,staticClass:"mui-table-view-cell mui-media mui-checkbox mui-left"},[a("a",{staticClass:"clearfix",attrs:{href:"javascript:;"}},[t.realSendQty==t.alreadyReturnQty?a("input",{directives:[{name:"model",rawName:"v-model",value:t.checked,expression:"item.checked"}],staticClass:"checked",attrs:{name:"checkbox",type:"checkbox",disabled:"disabled"},domProps:{checked:Array.isArray(t.checked)?e._i(t.checked,null)>-1:t.checked},on:{change:function(a){var s=t.checked,i=a.target,c=!!i.checked;if(Array.isArray(s)){var r=e._i(s,null);i.checked?r<0&&e.$set(t,"checked",s.concat([null])):r>-1&&e.$set(t,"checked",s.slice(0,r).concat(s.slice(r+1)))}else e.$set(t,"checked",c)}}}):a("input",{directives:[{name:"model",rawName:"v-model",value:t.checked,expression:"item.checked"}],staticClass:"checked",attrs:{name:"checkbox",type:"checkbox"},domProps:{checked:Array.isArray(t.checked)?e._i(t.checked,null)>-1:t.checked},on:{change:function(a){var s=t.checked,i=a.target,c=!!i.checked;if(Array.isArray(s)){var r=e._i(s,null);i.checked?r<0&&e.$set(t,"checked",s.concat([null])):r>-1&&e.$set(t,"checked",s.slice(0,r).concat(s.slice(r+1)))}else e.$set(t,"checked",c)}}}),e._v(" "),a("div",{staticClass:"list-img"},[a("img",{directives:[{name:"lazy",rawName:"v-lazy",value:e.baseurl+t.imgPath,expression:"baseurl+item.imgPath"}],staticClass:"mui-media-object mui-pull-left"})]),e._v(" "),a("div",{staticClass:"mui-media-body detail-info"},[a("h4",{staticClass:"list-name"},[e._v(e._s(t.skuName)),a("span",{staticClass:"price"},[e._v("￥"+e._s(t.unit_price)+"/"+e._s(t.unit))])]),e._v(" "),a("h5",{staticClass:"mui-ellipsis list-size"},[e._v("规格："+e._s(t.styleno))]),e._v(" "),a("h5",{staticClass:"mui-ellipsis list-size"},[e._v(" 商品编码: "+e._s(t.skuCode))]),e._v(" "),a("div",[a("h5",{staticClass:"mui-ellipsis def-text"},[e._v("请货量："+e._s(e._f("capitalize")(t.qty,t.equation_factor,t.unit,t.uom_default))+"\n                                ")]),e._v(" "),a("p",{staticClass:"mui-ellipsis list-deliver"},[a("span",[e._v("实发："+e._s(e._f("capitalize")(t.wms_outqyt,t.equation_factor,t.unit,t.uom_default)))]),e._v(" "),t.alreadyReturnQty?a("span",[e._v("已退："+e._s(e._f("capitalize")(t.alreadyReturnQty,t.equation_factor,t.unit,t.uom_default)))]):e._e()])])])])])}),0),e._v(" "),a("ul",{staticClass:"mui-table-view order-ul bg-write"},e._l(e.searchData,function(t,s){return a("li",{key:s,staticClass:"mui-table-view-cell mui-media mui-checkbox mui-left"},[a("a",{staticClass:"clearfix",attrs:{href:"javascript:;"}},[t.realSendQty==t.alreadyReturnQty?a("input",{directives:[{name:"model",rawName:"v-model",value:t.checked,expression:"item.checked"}],staticClass:"checked",attrs:{name:"checkbox",type:"checkbox",disabled:"disabled"},domProps:{checked:Array.isArray(t.checked)?e._i(t.checked,null)>-1:t.checked},on:{change:function(a){var s=t.checked,i=a.target,c=!!i.checked;if(Array.isArray(s)){var r=e._i(s,null);i.checked?r<0&&e.$set(t,"checked",s.concat([null])):r>-1&&e.$set(t,"checked",s.slice(0,r).concat(s.slice(r+1)))}else e.$set(t,"checked",c)}}}):a("input",{directives:[{name:"model",rawName:"v-model",value:t.checked,expression:"item.checked"}],staticClass:"checked",attrs:{name:"checkbox",type:"checkbox"},domProps:{checked:Array.isArray(t.checked)?e._i(t.checked,null)>-1:t.checked},on:{change:function(a){var s=t.checked,i=a.target,c=!!i.checked;if(Array.isArray(s)){var r=e._i(s,null);i.checked?r<0&&e.$set(t,"checked",s.concat([null])):r>-1&&e.$set(t,"checked",s.slice(0,r).concat(s.slice(r+1)))}else e.$set(t,"checked",c)}}}),e._v(" "),a("div",{staticClass:"list-img"},[a("img",{directives:[{name:"lazy",rawName:"v-lazy",value:e.baseurl+t.imgPath,expression:"baseurl+item.imgPath"}],staticClass:"mui-media-object mui-pull-left"})]),e._v(" "),a("div",{staticClass:"mui-media-body detail-info"},[a("h4",{staticClass:"list-name"},[e._v(e._s(t.skuName)),a("span",{staticClass:"price"},[e._v("￥"+e._s(t.unit_price)+"/"+e._s(t.unit))])]),e._v(" "),a("h5",{staticClass:"mui-ellipsis list-size"},[e._v("规格："+e._s(t.styleno))]),e._v(" "),a("h5",{staticClass:"mui-ellipsis list-size"},[e._v(" 商品编码: "+e._s(t.skuCode))]),e._v(" "),a("div",[a("h5",{staticClass:"mui-ellipsis def-text"},[e._v("请货量："+e._s(e._f("capitalize")(t.qty,t.equation_factor,t.unit,t.uom_default))+"\n                                ")]),e._v(" "),a("p",{staticClass:"mui-ellipsis list-deliver"},[a("span",[e._v("实发："+e._s(e._f("capitalize")(t.wms_outqyt,t.equation_factor,t.unit,t.uom_default)))]),e._v(" "),t.alreadyReturnQty?a("span",[e._v("已退："+e._s(e._f("capitalize")(t.alreadyReturnQty,t.equation_factor,t.unit,t.uom_default)))]):e._e()])])])])])}),0)]),e._v(" "),a("div",{staticClass:"bottom-btn"},[a("button",{staticClass:"def-btn",attrs:{type:"button"},on:{click:function(t){return t.stopPropagation(),e.submit(t)}}},[e._v("确定")])])],1),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:!e.isShow,expression:"!isShow"}],staticClass:"return-detail"},[a("div",{staticClass:"header"},[a("mt-header",{attrs:{title:"退货"}},[a("mt-button",{attrs:{slot:"left",icon:"back"},on:{click:function(t){e.isShow=!0}},slot:"left"})],1)],1),e._v(" "),a("div",{staticClass:"my-content order-detail"},[a("ul",{staticClass:"cart-ul"},e._l(e.outOrderList,function(t,s){return a("li",{key:s,staticClass:"cart-li"},[a("div",{staticClass:"cart-info"},[a("img",{directives:[{name:"lazy",rawName:"v-lazy",value:e.baseurl+t.imgPath,expression:"baseurl+item.imgPath"}],staticClass:"cart-img"}),e._v(" "),a("div",{staticClass:"cart-dec"},[a("h4",{staticClass:"skuName"},[e._v(e._s(t.skuName))]),e._v(" "),a("p",{staticClass:"styleno"},[e._v("规格："+e._s(t.styleno))]),e._v(" "),a("p",{staticClass:"styleno"},[e._v("货品编码："+e._s(t.skuCode))]),e._v(" "),a("p",{staticClass:"styleno"},[e._v("请货量："+e._s(e._f("capitalize")(t.qty,t.equation_factor,t.unit,t.uom_default))+"\n                            ")]),e._v(" "),a("p",{staticClass:"styleno"},[a("span",[e._v("实发："+e._s(e._f("capitalize")(t.wms_outqyt,t.equation_factor,t.unit,t.uom_default)))]),e._v(" "),a("span",[e._v("已退："+e._s(e._f("capitalize")(t.alreadyReturnQty,t.equation_factor,t.unit,t.uom_default)))])])])]),e._v(" "),a("div",{staticClass:"handle-info"},[a("div",{staticClass:"cartcontrol-wrapper"},[a("div",{staticClass:"countcontrol"},[e._v("\n                                退货数量:\n                                "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.value,expression:"item.value"}],staticClass:"unit-count",attrs:{type:"number",onkeyup:"value=value.replace(/[^0-9]/g,'')",onpaste:"value=value.replace(/[^0-9]/g,'')",oncontextmenu:"value=value.replace(/[^0-9]/g,'')"},domProps:{value:t.value},on:{blur:function(a){e.changeValue(t,s,a)},input:function(a){a.target.composing||e.$set(t,"value",a.target.value)}}}),a("span",{staticClass:"unit"},[e._v(e._s(t.unit))]),e._v(" "),a("input",{directives:[{name:"show",rawName:"v-show",value:"Y"==t.retail_flag,expression:"item.retail_flag=='Y'"},{name:"model",rawName:"v-model",value:t.mnum_value,expression:"item.mnum_value"}],staticClass:"uom-count",attrs:{type:"number",onkeyup:"value=value.replace(/[^0-9]/g,'')",onpaste:"value=value.replace(/[^0-9]/g,'')",oncontextmenu:"value=value.replace(/[^0-9]/g,'')"},domProps:{value:t.mnum_value},on:{blur:function(a){e.changeMnumValue(t,s,a)},input:function(a){a.target.composing||e.$set(t,"mnum_value",a.target.value)}}}),a("span",{directives:[{name:"show",rawName:"v-show",value:"Y"==t.retail_flag,expression:"item.retail_flag=='Y'"}],staticClass:"uom_default"},[e._v(e._s(t.uom_default))])])]),e._v(" "),a("div",{staticClass:"total-wrapper"},[a("div",[a("span",{ref:"totalPrice",refInFor:!0},[e._v("应退金额:￥"+e._s(t.must_amount))])])])])])}),0),e._v(" "),a("div",{staticClass:"textvalue"},[a("span",{staticClass:"cellm"},[e._v("异常描述")]),e._v(" "),a("textarea",{directives:[{name:"model",rawName:"v-model",value:e.note,expression:"note"}],attrs:{placeholder:"请输入描述信息"},domProps:{value:e.note},on:{input:function(t){t.target.composing||(e.note=t.target.value)}}})])]),e._v(" "),a("div",{staticClass:"bottom-btn"},[a("button",{directives:[{name:"show",rawName:"v-show",value:0==e.isShow,expression:"isShow==false"}],staticClass:"def-btn",attrs:{type:"button"},on:{click:function(t){return t.stopPropagation(),e.submitOrder(t)}}},[e._v("提交")])])])])},staticRenderFns:[]};var p=a("VU/8")(m,_,!1,function(e){a("epyF")},"data-v-1616ddb2",null);t.default=p.exports},epyF:function(e,t){}});