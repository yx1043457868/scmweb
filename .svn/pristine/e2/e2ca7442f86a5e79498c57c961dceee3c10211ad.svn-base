webpackJsonp([37],{"2Bvk":function(s,t,e){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=e("mvHQ"),a=e.n(i),r=(e("34+y"),e("X+yh")),o=e.n(r),l=e("y7b9"),n=e("HPsP"),c=e("0xDb"),u={name:"classify",components:{Tabbar:l.a,cartcontrol:n.a},data:function(){return{selected:"/classify",classTwoList:[],currentIndex:this.$route.query.tab?this.$route.query.tab:0,registerFlag:!!this.$store.getters.company,showList:[],ProductS:[],ProductT:[],scrollY:0,isShow:!this.$route.query.tab,searchTx:"",popupVisible:!1,curIndex:"",alwarysList:[],foodsScroll:null,scrollTop:this.$store.state.scrollY,shopType:this.$store.getters.shop.shopType?this.$store.getters.shop.shopType:4,timeNum:(new Date).valueOf()}},created:function(){this.initProduct()},activated:function(){this.registerFlag=!!this.$store.getters.company;var s=sessionStorage.getItem("scrollY")||0;this.$refs.foodList.scrollTo(0,s)},beforeRouteLeave:function(s,t,e){var i=this.$refs.foodList.scrollTop||0;sessionStorage.setItem("scrollY",i),sessionStorage.setItem("currentIndex",this.currentIndex),e()},methods:{addFood:function(s){this._drop(s)},_drop:function(s){var t=this;this.$nextTick(function(){t.$refs.shopcart.drop(s)})},search:function(){this.$router.push({path:"/search"})},initProduct:function(){var s=this,t=Object(c.d)(),e=this.$store.getters.account.shopId?this.$store.getters.account.shopId:"",i=this.$store.getters.shop.shopType?this.$store.getters.shop.shopType:"";this.$post("/appVpProduct/classProductList.do",{content:'{"companyId":"'+t+'","shopId":"'+e+'","shopType":"'+i+'"}',version:"kkllo",login_token:this.$store.getters.logintoken}).then(function(t){var e=JSON.parse(t);if("yes"==e.optFlag){for(var i,a=e.res,r=0;r<a.length;r++)for(var l=r;l<a.length;l++){(a[r].sort||0==parseFloat(a[r].sort)?parseFloat(a[r].sort):999999999999)>(a[l].sort||0==parseFloat(a[l].sort)?parseFloat(a[l].sort):999999999999)&&(i=a[r],a[r]=a[l],a[l]=i)}if(s.ProductT=a.map(function(s){var t=void 0;if(s.list)for(var e=0;e<s.list.length;e++)for(var i=e;i<s.list.length;i++){(s.list[e].classTwoSort||0==parseFloat(s.list[e].classTwoSort)?parseFloat(s.list[e].classTwoSort):999999999999)>(s.list[i].classTwoSort||0==parseFloat(s.list[i].classTwoSort)?parseFloat(s.list[i].classTwoSort):999999999999)&&(t=s.list[e],s.list[e]=s.list[i],s.list[i]=t)}return s}),"-1"!=s.currentIndex){s.ProductS=s.ProductT[s.currentIndex].list,s.ProductS.length>0?s.isShow=!1:s.isShow=!0;var n=s.ProductS.filter(function(s){return""!=s.class_two_id&&null!=s.class_two_id});s.classTwoList=s.array_merge(n,[])}}else o()({message:"商品加载失败",duration:1e3})})},_initScroll:function(){},alwarysByProductList:function(s){var t=this.$route.query.tab;this.curIndex="","0"==t&&"-2"==s?(this.currentIndex=t,this.initProduct()):t&&"-2"==s?(this.currentIndex=t,this.initProduct()):(this.currentIndex="-1",this.initAlwarysList(),this.initProduct())},initAlwarysList:function(){var s=this,t={companyId:Object(c.d)(),shopId:this.$store.getters.account.shopId?this.$store.getters.account.shopId:""};this.$post("/appVpProduct/alwarysByProductList.do",{content:a()(t),version:"kkllo",login_token:this.$store.getters.logintoken}).then(function(t){var e=JSON.parse(t);if("yes"==e.optFlag){s.ProductS=e.res.suggestList,s.alwarysList=e.res.suggestList,s.ProductS.length>0?s.isShow=!1:s.isShow=!0;var i=s.ProductS.filter(function(s){return""!=s.class_two_id&&null!=s.class_two_id});s.classTwoList=s.array_merge(i,[])}else o()("商品加载失败")})},selectMenu:function(s){this.curIndex="",this.currentIndex=s,this.ProductS=this.ProductT[s].list,this.ProductS.length>0?this.isShow=!1:this.isShow=!0;var t=this.ProductS.filter(function(s){return""!=s.class_two_id&&null!=s.class_two_id});this.classTwoList=this.array_merge(t,[]),this.$router.replace({path:"/classify",query:{tab:s}}),this.$refs.foodList.scrollTo(0,0)},array_merge:function(s,t){for(var e=0;e<s.length;e++){for(var i=!0,a=0;a<t.length;a++)s[e].class_two_id==t[a].class_two_id&&(i=!1);i&&t.push(s[e])}return t},selectSubMenu:function(s,t){this.popupVisible=!1,this.curIndex=s;var e=this.currentIndex;this.ProductS="-1"==e?this.alwarysList.filter(function(s){return s.class_two_id==t}):this.ProductT[e].list.filter(function(s){return s.class_two_id==t}),this.ProductS.length>0?this.isShow=!1:this.isShow=!0}}},p={render:function(){var s=this,t=s.$createElement,e=s._self._c||t;return e("div",{staticClass:"classify"},[e("div",{staticClass:"top-bar clearfix"},[e("div",{staticClass:"top-bar-box"},[e("div",{staticClass:"top_search  mui-pull-left"},[e("span",{staticClass:"search-icon iconfont"},[s._v("")]),s._v(" "),e("form",{attrs:{action:"#"}},[e("input",{directives:[{name:"model",rawName:"v-model",value:s.searchTx,expression:"searchTx"}],staticClass:"mui-pull-left",attrs:{type:"search",placeholder:"输入食材名称/编码/拼音搜索",id:"search_input"},domProps:{value:s.searchTx},on:{focus:s.search,input:function(t){t.target.composing||(s.searchTx=t.target.value)}}})])])])]),s._v(" "),e("div",{staticClass:"tab tabContent classifyBox"},[e("div",{ref:"menuWrapper",staticClass:"left menu-wrapper"},[e("ul",{attrs:{id:"typeList"}},s._l(s.ProductT,function(t,i){return e("li",{key:i,ref:"menuList",refInFor:!0,class:{cur:s.currentIndex==i},attrs:{id:t.ID,index:i},on:{click:function(t){s.selectMenu(i)}}},[e("span",[s._v(s._s(t.NAME))])])}),0)]),s._v(" "),e("div",{ref:"foodsWrapper",staticClass:"right foods-wrapper",attrs:{id:"goodsList"}},[e("div",{directives:[{name:"show",rawName:"v-show",value:s.classTwoList.length>0,expression:"classTwoList.length > 0 "}],staticClass:"fixed-bar"},[e("div",{ref:"slider",staticClass:"slider"},[e("div",{staticClass:"slider-group"},s._l(s.classTwoList,function(t,i){return e("div",{directives:[{name:"show",rawName:"v-show",value:t.class_two_name,expression:"item.class_two_name"}],key:i,staticClass:"slider-item",class:{cur:s.curIndex===i},attrs:{id:t.class_two_id},on:{click:function(e){s.selectSubMenu(i,t.class_two_id)}}},[s._v("\n                            "+s._s(t.class_two_name)+"\n                        ")])}),0)]),s._v(" "),e("div",{staticClass:"up-down",on:{click:function(t){s.popupVisible=!s.popupVisible}}},[e("span",{staticClass:"iconfont"},[s._v("")])]),s._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:s.popupVisible,expression:"popupVisible"}],staticClass:"popupVisible",on:{click:function(t){t.stopPropagation(),t.preventDefault(),s.popupVisible=!1}}},[e("div",{staticClass:"popWrap"},s._l(s.classTwoList,function(t,i){return e("div",{directives:[{name:"show",rawName:"v-show",value:t.class_two_name,expression:"item.class_two_name"}],key:i,staticClass:"pop-item",class:{cur:s.curIndex===i},attrs:{id:t.class_two_id},on:{click:function(e){s.selectSubMenu(i,t.class_two_id)}}},[e("span",[s._v(s._s(t.class_two_name))])])}),0)])]),s._v(" "),e("div",{ref:"foodList",staticClass:"tab_content",class:[s.classTwoList.length>0?"top-content":""],staticStyle:{overflow:"auto"}},[e("div",[e("ul",{staticClass:"goods-list"},s._l(s.ProductS,function(t,i){return e("router-link",{key:i,staticClass:"mui-table-view-cell",attrs:{to:{path:"/detail",query:{id:t.id}},tag:"li",pid:t.id}},[e("div",{staticClass:"food-link"},[e("img",{directives:[{name:"lazy",rawName:"v-lazy",value:s.baseurl+t.img_path+"?time="+s.timeNum,expression:"baseurl+food.img_path+'?time='+timeNum"}],key:t.img_path}),s._v(" "),e("span",{directives:[{name:"show",rawName:"v-show",value:"N"==t.is_enable,expression:"food.is_enable == 'N'"}],staticClass:"is_enable"},[s._v("已下架")]),s._v(" "),e("div",{staticClass:"recommend"},[e("h4",{staticClass:"skuName"},[s._v("\n                                        "+s._s(t.spu_name?t.spu_name:t.sku_name))]),s._v(" "),e("p",{staticClass:"styleno"},[s._v("规格:"+s._s(t.styleno))]),s._v(" "),t.full_gift&&2!=JSON.parse(t.full_gift).requireType?e("span",{staticClass:"tag"},[s._v("满赠")]):t.full_gift&&2==JSON.parse(t.full_gift).requireType?e("span",{staticClass:"tag"},[s._v("满减")]):s._e(),s._v(" "),e("p",{staticClass:"styleno"},[t.rkpriceList?e("span",{staticClass:"tag"},[s._v("以量定价")]):s._e()]),s._v(" "),e("p",{directives:[{name:"show",rawName:"v-show",value:s.registerFlag,expression:"registerFlag"}],staticClass:"styleno"},[e("span",{directives:[{name:"show",rawName:"v-show",value:4!=s.shopType,expression:"shopType!=4"}],staticStyle:{"font-size":"12px",color:"#e75b5a"}},[s._v("会员价：")])]),s._v(" "),e("span",{directives:[{name:"show",rawName:"v-show",value:!s.registerFlag,expression:"!registerFlag"}],staticClass:"price hide-price"},[s._v("价格:登录后可见")]),s._v(" "),e("span",{directives:[{name:"show",rawName:"v-show",value:s.registerFlag,expression:"registerFlag"}],staticClass:"price"},[e("span",{staticStyle:{color:"#e75b5a"}},[s._v("￥")]),s._v(" "),1==t.is_default_spu&&t.spu_min_unit_price?e("span",{staticStyle:{"font-size":"18px",color:"rgb(231, 91, 90)"}},[s._v(s._s(t.spu_min_unit_price))]):e("span",{staticStyle:{"font-size":"18px",color:"rgb(231, 91, 90)"}},[s._v(s._s(t.unit_price))]),s._v("/"+s._s(t.unit)+"\n                                        "),"Y"==t.retail_flag&&1!=t.is_default_spu?e("span",{staticClass:"retail_price"},[s._v("(￥"+s._s(t.price)+"/"+s._s(t.uom_default)+")")]):s._e(),s._v(" "),"Y"!=t.retail_flag||1!=t.is_default_spu||t.spu_min_price?s._e():e("span",{staticClass:"retail_price"},[s._v("(￥"+s._s(t.price)+"/"+s._s(t.uom_default)+")")]),s._v(" "),"Y"==t.retail_flag&&1==t.is_default_spu&&t.spu_min_price?e("span",{staticClass:"retail_price"},[s._v("(￥"+s._s(t.spu_min_price)+"/"+s._s(t.uom_default)+")")]):s._e(),s._v(" "),1==t.is_default_spu&&t.spu_min_unit_price?e("em",{staticClass:"begin",staticStyle:{"text-decoration":"none"}},[s._v("起")]):s._e()])])]),s._v(" "),e("div",{staticClass:"cartcontrol-wrapper"},[e("cartcontrol",{attrs:{food:t},on:{addCart:s.addFood}})],1)])}),1)])]),s._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:s.isShow,expression:"isShow"}],staticClass:"empty-box"},[s._m(0),s._v(" "),e("p",[s._v("亲,暂无相关数据哦~")])])])]),s._v(" "),e("Tabbar",{ref:"shopcart",attrs:{selected:s.selected}})],1)},staticRenderFns:[function(){var s=this.$createElement,t=this._self._c||s;return t("div",{staticClass:"empty-img"},[t("img",{attrs:{src:e("YHTk"),alt:""}})])}]};var d=e("VU/8")(u,p,!1,function(s){e("Dqpf")},"data-v-6a8f15e0",null);t.default=d.exports},Dqpf:function(s,t){}});