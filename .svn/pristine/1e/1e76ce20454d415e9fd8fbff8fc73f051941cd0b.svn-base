webpackJsonp([59],{"5HqF":function(t,e){},"8zp9":function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});i("34+y");var s=i("X+yh"),n=i.n(s),a=i("fxnj"),o=i.n(a),c=i("0xDb"),r=i("NC6I"),l=i.n(r),d={name:"Login",components:{},data:function(){return{linkman:"",phone:"",pwd:"",secCode:"",inviteCode:"",pcid:"",cid:"",cidName:"",city:"-1",disabled:!1,count:60,code_text:"获取验证码",intervalobj:null,companyList:[],provinceList:[],cityList:[],contactUsFalse:!1,recommend:"",latitude:"",longitude:""}},created:function(){var t=this.$route.query.pcid;this.$store.commit("setpcid",parseFloat(t)),this.isweixin()},filters:{formatPrePrice:function(t){return Object(c.o)(t)}},computed:{disabledReg:function(){return""==this.phone||""==this.pwd||""==this.secCode}},directives:{mtfocus:function(t,e,i){var s=t.querySelector("input");s.onfocus=function(){alert(this.phone)},s.onblur=function(){alert(this.phone)}}},methods:{isweixin:function(){"micromessenger"==window.navigator.userAgent.toLowerCase().match(/MicroMessenger/i)?this.wxRegister(this):this.getCompanyList(this)},wxRegister:function(t){var e=window.location.href.split("#")[0];this.$post("/share/signature.do?ts="+Math.random(),{url:e}).then(function(e){var i=JSON.parse(e);o.a.config({debug:!1,appId:i.appId,timestamp:i.timestamp,nonceStr:i.nonceStr,signature:i.signature,jsApiList:["getLocation"]}),o.a.ready(function(){o.a.getLocation({type:"wgs84",success:function(e){t.latitude=e.latitude,t.longitude=e.longitude;e.speed,e.accuracy;t.getCompanyList(t)},cancel:function(){t.getCompanyList(t)},fail:function(){t.getCompanyList(t)}})})}).catch(function(t){console.log(t)})},changecid:function(t){this.cidName=t.NAME,this.cid=t.itemId,this.contactUsFalse=!1},changeCity:function(t){t?(this.companyList=this.cityList.filter(function(e){return e.parentid==t}),this.contactUsFalse=!0,this.cid="",this.cidName=""):(this.companyList=[],this.cid="",this.cidName="")},back:function(){this.$router.push({path:"/login"})},CalcuMD5:function(t){return t=l()(t)},checkFhone:function(){var t=this,e="{'contactPhone':'"+this.phone+"'}";this.$post("/appAccount/appCheckPhone.do",{content:e,version:"kkllo",login_token:this.$store.getters.logintoken?this.$store.getters.logintoken:""}).then(function(e){var i=JSON.parse(e);"yes"==i.optFlag?t.checkCode():(n()(i.optDesc),t.phone="")})},getCompanyList:function(t){var e=t.$route.query.pcid?t.$route.query.pcid:Object(c.d)(),i="{'gpsLongitude':'"+t.longitude+"','gpsLatitude':'"+t.latitude+"','pcid':'"+e+"'}";t.$post("/appAccount/getNewCompanyListTo.do",{content:i,version:"kkllo",login_token:t.$store.getters.logintoken?t.$store.getters.logintoken:""}).then(function(e){var i=JSON.parse(e);if("yes"==i.optFlag){e=i.res;for(var s,a=0;a<e.length;a++)for(var o=a;o<e.length;o++){(e[a].distance||0==parseFloat(e[a].distance)?parseFloat(e[a].distance):999999999999)>(e[o].distance||0==parseFloat(e[o].distance)?parseFloat(e[o].distance):999999999999)&&(s=e[a],e[a]=e[o],e[o]=s)}t.cityList=e.filter(function(t){return 1===t.isUse}),t.provinceList=e.filter(function(t){return 0===t.isUse});var c=e[0];t.longitude&&t.latitude&&(t.pcid=c.itemId,t.cidName=c.NAME,t.cid=c.itemId,t.city=c.parentid),t.companyList=t.cityList.filter(function(e){return e.parentid==t.city}),t.provinceList.map(function(e){e.id==c.parentid&&(t.recommend=e.NAME)})}else n()({message:i.optDesc,duration:1e3})})},register:function(){var t=this;if(!Object(c.g)(this.phone))return n()({message:"请输入正确的手机号格式",duration:1e3}),!1;if(""==this.cid)return n()({message:"请选择门店",duration:1e3}),!1;var e=sessionStorage.shareId?sessionStorage.shareId:"",i="{'name':'"+this.linkman+"','contactPhone':'"+this.phone+"','pwd':'"+this.pwd+"','cid':'"+this.cid+"','secCode':'"+this.secCode+"','shareId':'"+e+"','realid':'','inviteCode':'"+this.inviteCode+"','deviceOS':'H5'}";this.$post("/appAccount/saveChildRegister.do",{content:i,version:"kkllo",login_token:this.$store.getters.logintoken?this.$store.getters.logintoken:""}).then(function(e){var i=JSON.parse(e);"yes"==i.optFlag?(n()({message:"注册成功",duration:1e3}),t.login()):n()({message:i.optDesc,duration:1e3})})},login:function(){var t=this,e="",i=this.CalcuMD5(this.CalcuMD5(this.pwd));e=navigator.userAgent.indexOf("Android")>-1||navigator.userAgent.indexOf("Linux")>-1?"android":"iPhone";var s="{'account':'"+this.phone+"','pwd':'"+i+"','deviceOS':'H5'}";this.$post("/appAccount/login.do",{content:s,version:"kkllo",deviceOS:e,login_token:this.$store.getters.logintoken}).then(function(e){var i=JSON.parse(e);if("yes"==i.optFlag){n()({message:"登录成功",duration:1e3}),t.$store.commit("setData",i.res);var s=i.res.company,a=i.res.account;i.res.shop;t.$store.commit("setpcid",parseFloat(s.id)),t.$router.push({path:"/",query:{pcid:a.companyId,firstRegister:1}})}else n()({message:i.optDesc,duration:1e3})})},checkCode:function(){var t=this,e="{'phone':'"+this.phone+"'}";this.intervalobj=setInterval(function(){t.count>0?(t.code_text=t.count+"s后重新获取",t.disabled=!0,t.count--):0==t.count&&(t.code_text="获取验证码",t.disabled=!1,clearInterval(t.intervalobj),t.count=60)},1e3),this.$post("/appAccount/sendYzm.do",{content:e,version:"kkllo",login_token:this.$store.getters.logintoken}).then(function(t){var e=JSON.parse(t);"yes"==e.optFlag?n()({message:"发送成功",duration:1e3}):n()({message:e.optDesc,duration:1e3})})},sendCode:function(){return""==this.phone?(n()({message:"请输入手机号",duration:1e3}),!1):Object(c.g)(this.phone)?void this.checkFhone():(n()({message:"请输入正确的手机号格式",duration:1e3}),!1)}}},u={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"login"},[i("header",{staticClass:"mint-header"},[i("div",{staticClass:"mint-header-button is-left",on:{click:t.back}},[t._m(0)]),t._v(" "),i("h1",{staticClass:"mint-header-title"},[t._v("注册")]),t._v(" "),i("div",{staticClass:"mint-header-button is-right"})]),t._v(" "),i("div",{staticClass:"login-box"},[t._m(1),t._v(" "),i("div",{staticClass:"login-group"},[i("form",{attrs:{action:"",autocomplete:"off"}},[i("div",{staticClass:"input-item"},[t._m(2),t._v(" "),i("span",{staticClass:"pie"},[t._v("|")]),t._v(" "),i("input",{directives:[{name:"model",rawName:"v-model",value:t.phone,expression:"phone"}],attrs:{type:"tel",placeholder:"请输入您的手机号",autofocus:"autofocus"},domProps:{value:t.phone},on:{input:function(e){e.target.composing||(t.phone=e.target.value)}}})]),t._v(" "),i("div",{staticClass:"input-item"},[t._m(3),t._v(" "),i("span",{staticClass:"pie"},[t._v("|")]),t._v(" "),i("input",{directives:[{name:"model",rawName:"v-model",value:t.secCode,expression:"secCode"}],attrs:{type:"text",placeholder:"请输入验证密码"},domProps:{value:t.secCode},on:{input:function(e){e.target.composing||(t.secCode=e.target.value)}}}),t._v(" "),i("button",{staticClass:"reg-btn",attrs:{type:"button",disabled:t.disabled},on:{click:t.sendCode}},[t._v("\n                        "+t._s(t.code_text)+"\n                    ")])]),t._v(" "),i("div",{staticClass:"input-item"},[t._m(4),t._v(" "),i("span",{staticClass:"pie"},[t._v("|")]),t._v(" "),i("input",{directives:[{name:"model",rawName:"v-model",value:t.pwd,expression:"pwd"}],attrs:{type:"password",placeholder:"请设置密码"},domProps:{value:t.pwd},on:{input:function(e){e.target.composing||(t.pwd=e.target.value)}}})]),t._v(" "),i("div",{staticClass:"input-item input-item-border"},[t._m(5),t._v(" "),i("span",{staticClass:"pie"},[t._v("|")]),t._v(" "),i("input",{directives:[{name:"model",rawName:"v-model",value:t.linkman,expression:"linkman"}],attrs:{type:"text",placeholder:"请输入联系人姓名（可不填）",autofocus:"autofocus"},domProps:{value:t.linkman},on:{input:function(e){e.target.composing||(t.linkman=e.target.value)}}})]),t._v(" "),i("div",{staticClass:"input-item input-item-border",staticStyle:{"margin-bottom":"0"}},[t._m(6),t._v(" "),i("span",{staticClass:"pie"},[t._v("|")]),t._v(" "),i("input",{directives:[{name:"model",rawName:"v-model",value:t.inviteCode,expression:"inviteCode"}],attrs:{type:"text",placeholder:"业务员邀请码（可不填）"},domProps:{value:t.inviteCode},on:{input:function(e){e.target.composing||(t.inviteCode=e.target.value)}}})]),t._v(" "),i("div",{staticClass:"serverItem"},[t._v("------------ 请选择为您服务的门店 ------------")]),t._v(" "),i("div",{staticClass:"input-item",staticStyle:{"margin-bottom":"0"}},[i("select",{directives:[{name:"model",rawName:"v-model",value:t.city,expression:"city"}],staticClass:"changStyleCity",attrs:{name:"city"},on:{change:[function(e){var i=Array.prototype.filter.call(e.target.options,function(t){return t.selected}).map(function(t){return"_value"in t?t._value:t.value});t.city=e.target.multiple?i:i[0]},function(e){t.changeCity(t.city)}]}},[i("option",{attrs:{value:"-1",disabled:"disabled"}},[t._v("请选择城市")]),t._v(" "),t._l(t.provinceList,function(e,s){return i("option",{key:s,domProps:{value:e.id}},[t._v(t._s(e.NAME))])})],2),t._v(" "),i("i",{staticClass:"icon iconfont colorIcon"},[t._v("")]),t._v(" "),i("div",{staticStyle:{height:"40px","line-height":"40px",width:"70%","text-align":"center"},on:{click:function(e){t.contactUsFalse=!0}}},[t._v("\n                        "+t._s(t.cidName)+"\n                    ")]),t._v(" "),i("i",{staticClass:"icon iconfont colorIcon"},[t._v("")])]),t._v(" "),t.latitude&&t.longitude?i("div",{staticClass:"changeServer"},[t._v("已自动为您定位就近门店，您也可以点击修改")]):i("div",{staticClass:"changeServer"},[t._v("定位关闭，获取门店距离不准，请打开定位后刷新")]),t._v(" "),i("button",{staticClass:"login-btn",attrs:{type:"button",size:"large",disabled:t.disabledReg},on:{click:t.register}},[t._v("\n                    注册\n                ")])]),t._v(" "),i("div",{staticClass:"link-box"},[i("router-link",{staticClass:"link",staticStyle:{"margin-right":"0"},attrs:{to:"/login"}},[t._v("\n                    已有账号，去登录 》\n                ")])],1),t._v(" "),i("div",{staticClass:"link-box"})])]),t._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:t.contactUsFalse,expression:"contactUsFalse"}],staticClass:"mask"},[i("div",{staticClass:"mask-table-view",on:{click:function(e){t.contactUsFalse=!1}}},[i("div",{staticClass:"mask-title"},[t._v("附近门店")]),t._v(" "),i("ul",{staticClass:"mui-table-view"},t._l(t.companyList,function(e,s){return i("li",{key:s,staticClass:"mui-table-view-cell mui-media",on:{click:function(i){t.changecid(e)}}},[i("a",{staticClass:"mui-navigate-right",attrs:{href:"javascript:;"}},[i("div",{staticClass:"mui-media-body"},[i("div",{staticClass:"clearfix shop-title"},[i("span",{staticClass:"mui-pull-left shop-name"},[t._v(t._s(e.NAME))]),t._v(" "),i("span",{directives:[{name:"show",rawName:"v-show",value:e.distance,expression:"item.distance"}],staticClass:"mui-pull-right mask-distance"},[t._v("距离您："+t._s(t._f("formatPrePrice")(e.distance))+"km")])]),t._v(" "),i("p",{directives:[{name:"show",rawName:"v-show",value:e.address,expression:"item.address"}],staticClass:"address-text"},[t._v("\n                                "+t._s(e.address)+"\n                            ")])])])])}),0)])])])},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("button",{staticClass:"mint-button mint-button--default mint-button--normal"},[e("span",{staticClass:"mint-button-icon"},[e("i",{staticClass:"mintui mintui-back"})]),this._v(" "),e("label",{staticClass:"mint-button-text"})])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"login-logo"},[e("img",{attrs:{src:i("7Otq"),alt:""}})])},function(){var t=this.$createElement,e=this._self._c||t;return e("label",{attrs:{for:""}},[e("i",{staticClass:"icon iconfont"},[this._v("")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("label",{attrs:{for:""}},[e("i",{staticClass:"icon iconfont"},[this._v("")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("label",{attrs:{for:""}},[e("i",{staticClass:"icon iconfont"},[this._v("")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("label",{attrs:{for:""}},[e("i",{staticClass:"icon iconfont"},[this._v("")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("label",{attrs:{for:""}},[e("i",{staticClass:"icon iconfont"},[this._v("")])])}]};var p=i("VU/8")(d,u,!1,function(t){i("5HqF")},"data-v-0e347348",null);e.default=p.exports}});