webpackJsonp([55],{"2gA9":function(t,i){},aUXA:function(t,i,s){"use strict";Object.defineProperty(i,"__esModule",{value:!0});s("OgVB");var e=s("/Lyv"),a=s.n(e),n=(s("34+y"),s("X+yh")),r=s.n(n),o=s("gsqX"),c=s.n(o),u=(s("mgS3"),s("0xDb")),l={name:"detail",data:function(){return{product:{},content:"0天00小时00分00秒",imgList:[],img_path:"",fnum_unit:0,mnum_unit:0,isShow:!1,shopCarts:[],owner:"",swiper:null,good:{},retailShow:!1,sku_dec:"",companyList:""}},computed:{shopCount:function(){var t=0;return this.$store.state.carts.forEach(function(i){t+=parseFloat(i.value)}),t}},created:function(){this.productDetail()},methods:{back:function(){if(window.history.length<=1)return this.$router.push({path:"/"}),!1;this.$router.go(-1)},countdowm:function(t){var i=this,s=window.setInterval(function(){var e=new Date,a=new Date(t).getTime()-e.getTime();if(a>0){var n=Math.floor(a/1e3/60/60/24),r=Math.floor(a/1e3/60/60%24),o=Math.floor(a/1e3/60%60),c=Math.floor(a/1e3%60);r=r<10?"0"+r:r,o=o<10?"0"+o:o,c=c<10?"0"+c:c;var u="";n>0&&(u=n+"天"+r+"小时"+o+"分"+c+"秒"),n<=0&&r>0&&(u=r+"小时"+o+"分"+c+"秒"),n<=0&&r<=0&&(u=o+"分"+c+"秒"),i.content="距结束还剩 "+u}else window.clearInterval(s),i.content="活动已结束"},1e3)},productDetail:function(){var t=this,i="{'id':'"+this.$route.query.id+"','companyId':'"+Object(u.d)()+"'}";this.$post("/appPreOrder/selectAppPreProductDetail.do",{content:i,version:"kkllo",login_token:this.$store.getters.logintoken}).then(function(i){var s=JSON.parse(i);if("yes"==s.optFlag){t.product=s.res.tPreproduct,t.companyList=s.res.list,t.countdowm(s.res.tPreproduct.endTime),t.sku_dec=s.res.tPreproduct.skuDec,t.img_path=s.res.tPreproduct.imgPath,s.res.tPreproductImg&&s.res.tPreproductImg.length>0?s.res.tPreproductImg.map(function(i,s){t.imgList.push(i.img_path)}):t.imgList=[],t.$nextTick(function(){t._initSwiper()});var e=t.$store.state.preorder.findIndex(function(t){return t.id==s.res.tPreproduct.id});t.fnum_unit=-1===e?s.res.tPreproduct.minNum||1:t.$store.state.preorder[e].value}else r()({message:"数据请求失败",duration:1e3})})},_initSwiper:function(){new c.a("#swiper",{loop:!0,pagination:".swiper-pagination",autoplay:2e3,direction:"horizontal",watchOverflow:!0,autoplayDisableOnInteraction:!1,slidesPerView:1,paginationClickable:!0,centeredSlides:!1,observer:!0,observeParents:!0})},add:function(t){var i=this;return this.$store.state.logindata.logintoken?-1===this.companyList.findIndex(function(t){return t.companyId==Object(u.d)()})?(a()("提示","当前货品不在预售门店范围内"),!1):"N"==t.isEnable?(r()({message:"该商品已下架！",duration:950}),!1):void(this.isShow=!0):(a.a.confirm("请先登录系统").then(function(t){i.$router.push({path:"/login"})}).catch(function(){}),!1)},changeValue:function(t,i){var s=i.target.value;-1!=this.fnum_unit.toString().indexOf(".")&&r()("该商品只能输入整数"),this.fnum_unit=parseInt(s.toString().replace(/[^\d]+/g,""))||0,""==this.fnum_unit&&(this.fnum_unit=0)},confirm:function(t){if("Y"!=t.retail_flag){if(""==this.fnum_unit||0==this.fnum_unit)return r()("采购数量不能为0"),!1}else if(!(""!=this.fnum_unit&&0!=this.fnum_unit||""!=this.mnum_unit&&0!=this.mnum_unit))return r()("采购数量不能为0"),!1;this.isShow=!1;var i=this.$store.state.preorder.findIndex(function(i){return i.id==t.id});-1===i?(t.value=this.fnum_unit,t.checked=!0,this.$store.commit("addPrecarts",t),r()("加入采购单成功！")):(this.$store.state.preorder[i].value=this.fnum_unit,this.$store.commit("setPreorder",this.$store.state.preorder),r()("加入采购单成功！"))},addCart:function(t){this.fnum_unit?this.fnum_unit++:this.fnum_unit=1},decreaseCart:function(t){return this.fnum_unit<=0?(this.fnum_unit=0,r()({message:"宝贝不能再减少啦！",duration:950}),!1):this.fnum_unit>t.minNum?void(this.fnum_unit-=1):(r()("该货品"+t.minNum+t.unit+"起预购"),!1)}}},d={render:function(){var t=this,i=t.$createElement,s=t._self._c||i;return s("div",{staticClass:"product_detail"},[s("div",{staticClass:"goods_banner"},[s("div",{staticClass:"back",on:{click:t.back}},[s("i",{staticClass:"iconfont"},[t._v("")])]),t._v(" "),s("div",{staticClass:"swiper-container goods-container",attrs:{id:"swiper"}},[s("div",{staticClass:"swiper-wrapper"},[t._l(t.imgList,function(i,e){return s("div",{directives:[{name:"show",rawName:"v-show",value:t.imgList&&t.imgList.length>0,expression:"imgList && imgList.length>0"}],key:e,staticClass:"swiper-slide"},[s("img",{staticClass:"img-dec",attrs:{src:t.baseurl+i}})])}),t._v(" "),0==t.imgList.length?s("div",{staticClass:"swiper-slide"},[s("img",{staticClass:"img-dec",attrs:{src:t.baseurl+t.img_path,alt:t.product.sku_name}})]):t._e()],2),t._v(" "),s("div",{staticClass:"swiper-pagination"})]),t._v(" "),s("div",{staticClass:"time-content"},[s("span",{staticClass:"content"},[t._v(t._s(t.content))])])]),t._v(" "),s("div",{staticClass:"pre-info"},[s("h4",{staticClass:"list-name mui-ellipsis"},[t._v(t._s(t.product.skuName)+"\n        ")]),t._v(" "),s("p",{staticClass:"list-size mui-ellipsis"},[t._v("规格："+t._s(t.product.styleno))]),t._v(" "),t.product.lightMark?s("p",{staticClass:"light-mark"},[t._v(t._s(t.product.lightMark))]):t._e(),t._v(" "),s("span",[s("em",{staticClass:"pre-price"},[t._v("￥"+t._s(t.product.preunitPrice)+"/"+t._s(t.product.unit))]),t._v(" "),s("span",{staticClass:"min-num"},[t._v(t._s(t.product.minNum)+t._s(t.product.unit)+"起预购")])]),t._v(" "),s("span",{staticClass:"pre-r"},[t._v("现在下单预支付"+t._s(t.product.preScale)+"%")])]),t._v(" "),t.sku_dec&&""!=t.sku_dec?s("div",{staticClass:"product-text"},[t._m(0),t._v(" "),s("p",{staticClass:"dec-text",domProps:{innerHTML:t._s(t.sku_dec)}})]):t._e(),t._v(" "),s("ul",{staticClass:"pre-company mt-10"},[s("h4",{staticClass:"t-title"},[t._v("可预售门店")]),t._v(" "),t._l(t.companyList,function(i,e){return s("li",{key:e},[s("h5",{staticClass:"list-title clearfix"},[s("span",{staticClass:"mui-pull-left"},[t._v(t._s(i.contactPhone))]),t._v(" "),s("span",{staticClass:"mui-pull-right"},[t._v(t._s(i.cityCn))])]),t._v(" "),s("p",[t._v(t._s(i.nm))])])})],2),t._v(" "),t.isShow?s("section",{staticClass:"dialogMask",attrs:{id:"dialogMask"},on:{click:function(i){t.isShow=!1}}}):t._e(),t._v(" "),s("transition",{attrs:{name:"slide","enter-active-class":"animated slideInUp","leave-active-class":"animated slideOutDown"}},[t.isShow?s("div",{staticClass:"dialog-wrapper",attrs:{id:"dialog"}},[s("div",{staticClass:"dialog-box"},[s("ul",{staticClass:"goods-list dialog-goods",attrs:{id:"dialog-goods"}},[s("li",{staticClass:"mui-table-view-cell"},[s("div",{staticClass:"food-link"},[s("img",{attrs:{src:t.baseurl+t.img_path}}),t._v(" "),s("div",{staticClass:"recommend"},[s("span",{staticClass:"close-dialog",on:{click:function(i){i.stopPropagation(),t.isShow=!1}}},[t._v("×")]),t._v(" "),s("h4",{staticClass:"skuName"},[t._v(t._s(t.product.skuName))]),t._v(" "),s("p",{staticClass:"styleno"},[t._v("规格："+t._s(t.product.styleno))]),t._v(" "),s("span",{staticClass:"price"},[t._v("预购价：￥"+t._s(t.product.preunitPrice)+"/"+t._s(t.product.unit))])])])])]),t._v(" "),s("div",{staticClass:"input-content"},[s("label",{staticClass:"left"},[t._v("订购数量("+t._s(t.product.unit)+")：")]),t._v(" "),s("div",{staticClass:"right input-row"},[s("div",{staticClass:"cartcontrol"},[s("button",{staticClass:"cart-decrease",on:{click:function(i){i.stopPropagation(),i.preventDefault(),t.decreaseCart(t.product)}}},[t._v("-")]),t._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:t.fnum_unit,expression:"fnum_unit"}],staticClass:"cart-count",attrs:{type:"number",onkeyup:"value=value.replace(/[^0-9]/g,'')",onpaste:"value=value.replace(/[^0-9]/g,'')",oncontextmenu:"value=value.replace(/[^0-9]/g,'')"},domProps:{value:t.fnum_unit},on:{blur:function(i){t.changeValue(t.product,i)},input:function(i){i.target.composing||(t.fnum_unit=i.target.value)}}}),t._v(" "),s("button",{staticClass:"cart-add",on:{click:function(i){i.stopPropagation(),i.preventDefault(),t.addCart(t.product)}}},[t._v("+")])])])]),t._v(" "),s("button",{staticClass:"sure_btn",on:{click:function(i){t.confirm(t.product)}}},[t._v("确定")])])]):t._e()]),t._v(" "),s("div",{staticClass:"toolbar"},["N"==t.product.isEnable?s("button",{staticClass:"mui-btn add-btn",staticStyle:{width:"100%"},attrs:{type:"button",disabled:"disabled"}},[t._v("已下架")]):s("button",{staticClass:"mui-btn add-btn",staticStyle:{width:"100%"},attrs:{type:"button"},on:{click:function(i){i.stopPropagation(),t.add(t.product)}}},[t._v("加入采购单")])])],1)},staticRenderFns:[function(){var t=this.$createElement,i=this._self._c||t;return i("h4",{staticClass:"dec-title"},[i("span",[this._v("---商品信息---")])])}]};var p=s("VU/8")(l,d,!1,function(t){s("2gA9")},"data-v-20a61acf",null);i.default=p.exports}});