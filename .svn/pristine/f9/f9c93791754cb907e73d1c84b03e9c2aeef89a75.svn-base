webpackJsonp([54],{TY6w:function(t,s){},dwST:function(t,s,e){"use strict";Object.defineProperty(s,"__esModule",{value:!0});e("34+y");var i=e("X+yh"),a=e.n(i),r=e("mvHQ"),o=e.n(r),n=e("/8Sv"),c=e("HPsP"),l=e("2nmU"),h=e("0xDb"),u={name:"Search",components:{cartcontrol:c.a,emptyBox:l.a,cartBox:n.a},data:function(){return{isShow:!0,registerFlag:!!this.$store.getters.company,selected:"/",value:sessionStorage.searchValue?sessionStorage.searchValue:"",ProductS:[],tip:!1,historyList:localStorage.getItem("historyList")?JSON.parse(localStorage.getItem("historyList")):[],shopType:this.$store.getters.shop.shopType?this.$store.getters.shop.shopType:4}},directives:{focus:{inserted:function(t){t.focus()}}},mounted:function(){var t=this;this.$nextTick(function(){t.$refs.input.focus()})},created:function(){this.search()},methods:{back:function(){if(window.history.length<=1)return this.$router.push({path:"/"}),!1;sessionStorage.searchValue="",this.$router.back(-1)},addFood:function(t){this._drop(t)},_drop:function(t){var s=this;this.$nextTick(function(){s.$refs.shopcart.drop(t)})},keySearch:function(t){this.value=t,this.search()},clearHis:function(){this.historyList=[],localStorage.setItem("historyList",o()(this.historyList))},searchVal:function(t){t=t.trim(),this.historyList.length>0&&-1!==this.historyList.indexOf(t)?(this.historyList.splice(this.historyList.indexOf(t),1),this.historyList.unshift(t)):this.historyList.unshift(t),this.historyList.length>6&&this.historyList.pop(),localStorage.setItem("historyList",o()(this.historyList))},search:function(){var t=this,s="";if(!this.value)return!1;sessionStorage.searchValue=this.value;var e=Object(h.d)();s=this.$store.state.logindata?this.$store.state.logindata.company.owner:"";var i=this.$store.getters.account.shopId?this.$store.getters.account.shopId:"",r=this.$store.getters.shop.shopType?this.$store.getters.shop.shopType:"",o="{'companyId':'"+e+"','skuname':'"+this.value+"','shopId':'"+i+"','shopType':'"+r+"','owner':'"+s+"','skucode':''}";this.searchVal(this.value),this.isShow=!1,this.$post("/appVpProduct/productList.do",{content:o,version:"kkllo",login_token:this.$store.getters.logintoken}).then(function(s){var e=JSON.parse(s);"yes"==e.optFlag?e.res.list.length>0?(t.tip=!1,t.ProductS=e.res.list):(t.tip=!0,t.ProductS=[]):(a()({message:"商品查询失败",duration:1e3}),t.tip=!0)})}}},p={render:function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",[e("div",{staticClass:"header"},[e("header",{staticClass:"mint-header search-header"},[e("div",{staticClass:"mint-header-button is-left",on:{click:t.back}},[t._m(0)]),t._v(" "),e("div",{staticClass:"mint-search"},[e("form",{attrs:{action:"",target:"frameFile"}},[e("div",{staticClass:"mint-searchbar"},[e("div",{staticClass:"mint-searchbar-inner"},[e("i",{staticClass:"mintui mintui-search"}),t._v(" "),e("input",{directives:[{name:"focus",rawName:"v-focus"},{name:"model",rawName:"v-model",value:t.value,expression:"value"}],ref:"input",staticClass:"mint-searchbar-core",attrs:{type:"search",placeholder:"输入食材名称/编码/拼音搜索",autofocus:"autofocus"},domProps:{value:t.value},on:{keyup:function(s){return"button"in s||!t._k(s.keyCode,"enter",13,s.key,"Enter")?t.search(s):null},input:function(s){s.target.composing||(t.value=s.target.value)}}})]),t._v(" "),e("a",{staticClass:"mint-searchbar-cancel",on:{click:t.search}},[t._v("搜索")])])]),t._v(" "),e("iframe",{staticStyle:{display:"none"},attrs:{name:"frameFile"}})])])]),t._v(" "),e("div",{staticClass:"my-content"},[t.isShow?e("div",{staticClass:"search-key"},[e("div",{staticClass:"clearfix"},[e("span",{staticClass:"mui-pull-left"},[t._v("历史搜索记录")]),e("span",{staticClass:"mui-pull-right clearHis",on:{click:t.clearHis}},[t._v("清空历史")])]),t._v(" "),e("ul",{staticClass:"key-box"},t._l(t.historyList,function(s,i){return e("li",{key:i,staticClass:"search-item",on:{click:function(e){t.keySearch(s)}}},[e("span",[t._v(t._s(s))])])}),0)]):t._e(),t._v(" "),e("div",[e("ul",{staticClass:"goods-list",attrs:{id:"goodsList"}},t._l(t.ProductS,function(s,i){return e("li",{key:i,staticClass:"mui-table-view-cell search-li",attrs:{pid:s.id,chag:s.equation_factor,class_id:s.class_id}},[e("router-link",{attrs:{to:{path:"/detail",query:{id:s.id}}}},[e("div",{staticClass:"food-link"},[e("img",{directives:[{name:"lazy",rawName:"v-lazy",value:t.baseurl+s.img_path,expression:"baseurl+food.img_path"}]}),t._v(" "),e("div",{staticClass:"recommend"},[e("h4",{staticClass:"skuName"},[t._v(t._s(s.sku_name))]),t._v(" "),e("p",{staticClass:"styleno"},[t._v("规格："+t._s(s.styleno))]),e("br"),t._v(" "),s.full_gift&&2!=JSON.parse(s.full_gift).requireType?e("span",{staticClass:"tag"},[t._v("满赠")]):s.full_gift&&2==JSON.parse(s.full_gift).requireType?e("span",{staticClass:"tag"},[t._v("满减")]):t._e(),t._v(" "),e("span",{directives:[{name:"show",rawName:"v-show",value:t.registerFlag,expression:"registerFlag"}],staticClass:"price"},[e("span",{directives:[{name:"show",rawName:"v-show",value:4!=t.shopType,expression:"shopType!=4"}],staticStyle:{"font-size":"12px"}},[t._v("会员价：")]),t._v("￥"+t._s(s.unit_price)+"/"+t._s(s.unit))]),t._v(" "),e("span",{directives:[{name:"show",rawName:"v-show",value:!t.registerFlag,expression:"!registerFlag"}],staticClass:"price"},[t._v("价格:登录后可见")])])]),t._v(" "),e("div",{staticClass:"cartcontrol-wrapper"},[e("cartcontrol",{attrs:{food:s},on:{addCart:t.addFood}})],1)])],1)}),0)])]),t._v(" "),e("emptyBox",{directives:[{name:"show",rawName:"v-show",value:t.tip,expression:"tip"}],attrs:{tiptext:"亲,暂无相关数据哦~"}}),t._v(" "),e("cartBox",{ref:"shopcart"})],1)},staticRenderFns:[function(){var t=this.$createElement,s=this._self._c||t;return s("button",{staticClass:"mint-button mint-button--default mint-button--normal"},[s("span",{staticClass:"mint-button-icon"},[s("i",{staticClass:"mintui mintui-back"})]),this._v(" "),s("label",{staticClass:"mint-button-text"})])}]};var d=e("VU/8")(u,p,!1,function(t){e("TY6w")},"data-v-2c23804a",null);s.default=d.exports}});