webpackJsonp([25],{"790Y":function(e,t){},noHZ:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i("OgVB");var a=i("/Lyv"),o=i.n(a),s=(i("34+y"),i("X+yh")),n=i.n(s),r=i("teIl"),d=i("0xDb"),c={name:"prePay",data:function(){return{sumAmount:"",couponAmountStr:"",couponAmount:0,payStatus:"",tailAmount:"",preAmount:"",preOrderCode:"",code:this.$route.query.orderCode,switchvalue:!1,checkedValue:"",isWeixinBrowser:Object(d.i)(),wxcode:"",openid:"",preCode:""}},components:{Header:r.a},created:function(){this.initPreInfo();var e=Object(d.e)("code");Object(d.i)()&&(this.$store.getters.openId||(e?this.getOpenIdByCode(e):this.authorize()))},mounted:function(){},methods:{authorize:function(){var e=Object(d.e)("code"),t=this.appid,i=location.origin+"/prePay?orderCode="+this.code,a="https://open.weixin.qq.com/connect/oauth2/authorize?appid="+t+"&redirect_uri="+encodeURIComponent(i)+"&response_type=code&scope=snsapi_base&state=STATE#wechat_redirect";e?(this.wxcode=e,this.$store.getters.openId||this.getOpenIdByCode(e)):window.location.href=a},back:function(){if(window.history.length<=1)return this.$router.push({path:"/"}),!1;this.$router.push({path:"/orderList"})},initPreInfo:function(){var e=this;this.$post("/appPreOrder/getPayMoney.do",{out_trade_no:this.code}).then(function(t){var i=JSON.parse(t);"yes"==i.optFlag?(e.preOrderCode=i.res.orderCode,e.sumAmount="￥"+i.res.sumAmount,e.preAmount="￥"+i.res.preAmount,e.couponAmountStr="￥-"+i.res.couponAmount,e.couponAmount=i.res.couponAmount,e.tailAmount="￥"+i.res.tailAmount,e.payStatus=i.res.payStatus):n()({message:i.optDesc,duration:950})})},aliPay:function(){"2"==this.payStatus?this.preCode=this.code+"_1":"3"==this.payStatus?this.preCode=this.code+"_2":this.preCode=this.code,window.location.href=this.baseurl+"preOrder/scanCodePayMent.do?decType=mobile&payType=ALI&out_trade_no="+this.preCode},wxcodePay:function(){"2"==this.payStatus?this.preCode=this.code+"_1":"3"==this.payStatus?this.preCode=this.code+"_2":this.preCode=this.code,window.location.href=this.baseurl+"preOrder/scanCodePayMent.do?decType=mobile&payType=WX&out_trade_no="+this.preCode},getOpenIdByCode:function(e){var t=this,i={code:e||this.wxcode,orderCode:this.code};this.$post("/wx/getOpenIdByCode.do",i).then(function(e){var i=JSON.parse(e);"yes"==i.optFlag&&(t.$store.commit("setOpenId",i.res.openid),t.openid=i.res.openid)})},wxH5Pay:function(){var e,t=this;if(e="/appPreOrder/jsWxApiPayMent.do","2"==this.payStatus?this.preCode=this.code+"_1":"3"==this.payStatus?this.preCode=this.code+"_2":this.preCode=this.code,Object(d.i)())try{this.$post(e,{out_trade_no:this.preCode,openid:this.openid?this.openid:this.$store.getters.openId}).then(function(e){var i=JSON.parse(e);if("yes"==i.optFlag){var a=JSON.parse(i.result),o=JSON.parse(a.pay_info);t.weixinPay(o)}else n()(i.optDesc)})}catch(e){n()({message:"支付异常",duration:950})}else n()({message:"仅在微信客户端使用",duration:950})},weixinPay:function(e){"undefined"==typeof WeixinJSBridge?document.addEventListener?document.addEventListener("WeixinJSBridgeReady",this.onBridgeReady(e),!1):document.attachEvent&&(document.attachEvent("WeixinJSBridgeReady",this.onBridgeReady(e)),document.attachEvent("onWeixinJSBridgeReady",this.onBridgeReady(e))):this.onBridgeReady(e)},onBridgeReady:function(e){var t=this;WeixinJSBridge.invoke("getBrandWCPayRequest",{appId:e.appId,timeStamp:e.timeStamp,nonceStr:e.nonceStr,package:e.package,signType:e.signType,paySign:e.paySign},function(e){"get_brand_wcpay_request:ok"==e.err_msg?t.back():"get_brand_wcpay_request:cancel"==e.err_msg?n()("您已取消支付"):"get_brand_wcpay_request:fail"==e.err_msg&&o()("提示",e.err_desc)})},confirmBtn:function(){this.checkedValue||n()("请选择支付结算类型"),"微信客户端支付"==this.checkedValue&&this.wxH5Pay(),"支付宝"==this.checkedValue&&this.aliPay(),"微信"==this.checkedValue&&this.wxcodePay()}}},u={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"order_pay"},[a("div",{staticClass:"header"},[a("mt-header",{attrs:{title:"支付"}},[a("mt-button",{attrs:{slot:"left",icon:"back"},on:{click:e.back},slot:"left"})],1)],1),e._v(" "),a("div",{staticClass:"my-content"},[a("div",{staticClass:"pay-info"},[e._m(0),e._v(" "),a("div",{staticClass:"mui-input-group"},[a("div",{staticClass:"mui-input-row coder-input"},[a("label",[e._v("订单号")]),e._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:e.preOrderCode,expression:"preOrderCode"}],attrs:{type:"text",readonly:"readonly"},domProps:{value:e.preOrderCode},on:{input:function(t){t.target.composing||(e.preOrderCode=t.target.value)}}})]),e._v(" "),a("div",{staticClass:"mui-input-row coder-input"},[a("label",[e._v("订单总额")]),e._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:e.sumAmount,expression:"sumAmount"}],staticClass:"code-red",attrs:{type:"text",readonly:"readonly"},domProps:{value:e.sumAmount},on:{input:function(t){t.target.composing||(e.sumAmount=t.target.value)}}})]),e._v(" "),"2"==e.payStatus?a("div",{staticClass:"mui-input-row coder-input",attrs:{id:"preAmount"}},[a("label",[e._v("应付定金")]),e._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:e.preAmount,expression:"preAmount"}],staticClass:"code-red",attrs:{type:"text",readonly:"readonly"},domProps:{value:e.preAmount},on:{input:function(t){t.target.composing||(e.preAmount=t.target.value)}}})]):e._e(),e._v(" "),"3"==e.payStatus&&e.couponAmount>0?a("div",{staticClass:"mui-input-row coder-input",attrs:{id:"preAmount"}},[a("label",[e._v("优惠券抵扣")]),e._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:e.couponAmountStr,expression:"couponAmountStr"}],staticClass:"code-red",attrs:{type:"text",readonly:"readonly"},domProps:{value:e.couponAmountStr},on:{input:function(t){t.target.composing||(e.couponAmountStr=t.target.value)}}})]):e._e(),e._v(" "),"3"==e.payStatus?a("div",{staticClass:"mui-input-row coder-input",attrs:{id:"preAmount"}},[a("label",[e._v("应付尾款")]),e._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:e.tailAmount,expression:"tailAmount"}],staticClass:"code-red",attrs:{type:"text",readonly:"readonly"},domProps:{value:e.tailAmount},on:{input:function(t){t.target.composing||(e.tailAmount=t.target.value)}}})]):e._e()])]),e._v(" "),a("div",{staticClass:"pay-ways",attrs:{id:"onlineWay"}},[e._m(1),e._v(" "),a("div",[a("ul",{staticClass:"mui-table-view"},[a("li",{staticClass:"mui-table-view-cell abvanceradio"},[a("div",{staticClass:"mui-navigate-right mui-radio"},[a("label",[a("input",{directives:[{name:"model",rawName:"v-model",value:e.checkedValue,expression:"checkedValue"}],attrs:{type:"radio",name:"advance",value:"微信客户端支付"},domProps:{checked:e._q(e.checkedValue,"微信客户端支付")},on:{change:function(t){e.checkedValue="微信客户端支付"}}}),e._v(" "),a("img",{staticClass:"mui-media-object mui-pull-left",attrs:{src:i("iIj2")}}),e._v(" "),e._m(2)])])]),e._v(" "),a("li",{staticClass:"mui-table-view-cell abvanceradio"},[a("div",{staticClass:"mui-navigate-right mui-radio"},[a("label",[a("input",{directives:[{name:"model",rawName:"v-model",value:e.checkedValue,expression:"checkedValue"}],attrs:{type:"radio",name:"advance",value:"支付宝"},domProps:{checked:e._q(e.checkedValue,"支付宝")},on:{change:function(t){e.checkedValue="支付宝"}}}),e._v(" "),a("img",{staticClass:"mui-media-object mui-pull-left",attrs:{src:i("V+CS")}}),e._v(" "),e._m(3)])])]),e._v(" "),a("li",{staticClass:"mui-table-view-cell"},[a("div",{staticClass:"mui-navigate-right  abvanceradio"},[a("div",{staticClass:"mui-media-body mui-radio"},[a("label",[a("input",{directives:[{name:"model",rawName:"v-model",value:e.checkedValue,expression:"checkedValue"}],attrs:{type:"radio",name:"advance",value:"微信"},domProps:{checked:e._q(e.checkedValue,"微信")},on:{change:function(t){e.checkedValue="微信"}}}),e._v(" "),a("img",{staticClass:"mui-media-object mui-pull-left",attrs:{src:i("PWGk")}}),e._v("\n                                    微信付款码\n                                    "),a("p",{staticClass:"mui-ellipsis"},[e._v("微信付款码支付")])])])])])])])]),e._v(" "),a("div",{staticClass:"bottom-btn"},[a("button",{staticClass:"def-btn",attrs:{type:"button"},on:{click:e.confirmBtn}},[e._v("确认支付")])])])])},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"pay-title"},[t("h5",[this._v("订单信息")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"pay-title"},[t("h5",[this._v("线上支付类型")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"mui-media-body"},[this._v("\n                                    微信支付\n                                    "),t("p",{staticClass:"mui-ellipsis"},[this._v("微信安全支付")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"mui-media-body"},[this._v("\n                                    支付宝付款码\n                                    "),t("p",{staticClass:"mui-ellipsis"},[this._v("支付宝付款码支付")])])}]};var p=i("VU/8")(c,u,!1,function(e){i("790Y")},"data-v-b6bb337c",null);t.default=p.exports}});