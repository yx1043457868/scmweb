webpackJsonp([39],{S5qY:function(s,t){},ZbGw:function(s,t,e){"use strict";Object.defineProperty(t,"__esModule",{value:!0});e("OgVB");var i=e("/Lyv"),o=e.n(i),a=e("Dd8w"),n=e.n(a),c=e("teIl"),r=e("0xDb"),d=e("NYxO"),l={name:"cofirmConvert",components:{Header:c.a},data:function(){return{shopInfo:{},node:"",selectAddressList:"",orderCode:"",isDisable:!0}},created:function(){this.initAddress(),this.changeAdsByCookie(),this.salesorders&&0!=this.salesorders.length||this.$router.push({path:"/integralList"})},computed:n()({},Object(d.a)(["integralsCount"]),{salesorders:function(){return this.$store.state.integrals},totalPoints:function(){return this.$store.state.integrals.reduce(function(s,t,e){return t.checked?s+t.points*t.value:s},0)}}),methods:{back:function(){this.$router.back(-1)},changeAdsByCookie:function(){var s=this.$store.state.address;this.selectAddressList=null==s||""==s?"":s},initAddress:function(){var s=this,t=this.$store.getters.account,e=t.shopId,i=(t.account,"{'shopId':'"+e+"','companyId':'"+t.companyId+"'}");this.$post("/appShippingAddress/appVpShopAddress.do",{content:i,version:"kkllo",login_token:this.$store.getters.logintoken}).then(function(t){var e=JSON.parse(t);"yes"==e.optFlag?(e.shop&&(s.shopInfo=e.shop),s.shopPickAdd=e.VpShopAddress,s.isDisable=!1):s.isDisable=!0})},touchstart:function(){},selectAddress:function(){this.$router.push({path:"/selectAddress"})},submitOrder:function(){var s=this;if(s.isDisable=!0,s.selectAddressList){if(Object(r.f)(s.selectAddressList.shopTact)||Object(r.f)(s.selectAddressList.shopTel)||Object(r.f)(s.selectAddressList.address))return o()("提示","请编辑收货地址"),s.isDisable=!1,!1}else if(Object(r.f)(s.shopInfo)||Object(r.f)(s.shopInfo.address)||Object(r.f)(s.shopInfo.shopTact)||Object(r.f)(s.shopInfo.shopTel))return o()("提示","请编辑收货地址"),s.isDisable=!1,!1;var t=this.$store.getters.account,e=(this.$store.getters.company,this.$store.getters.shop),i=t.companyId,a=e.id,n=t.account;if(s.selectAddressList)var c=s.selectAddressList.shopTact||"",d=s.selectAddressList.shopTel||"",l=s.selectAddressList.province+s.selectAddressList.city+s.selectAddressList.address;else c=s.shopInfo.shopTact||"",d=s.shopInfo.shopTel||"",s.shopInfo.province_id,l=s.shopInfo.province+s.shopInfo.city+s.shopInfo.address;var p=new Array;s.salesorders.forEach(function(s,t){var e=[];e.push("'id':'"+s.id+"'"),e.push("'qty':'"+s.value+"'"),p.push("{"+e.join(",")+"}")});var h="{'shopId': '"+a+"','companyId': '"+i+"','receiveName': '"+c+"','receivePhone': '"+d+"','receiveAddress': '"+l+"','skuJson': ["+p.join(",")+"],'createBy': '"+n+"','note': '"+s.node+"'}";s.$post("/points/addPointsorder.do",{content:h,version:"kkllo",login_token:this.$store.getters.logintoken}).then(function(t){var e=JSON.parse(t);"yes"==e.optFlag?(s.$store.commit("clearintegrals",[]),s.$router.push({path:"/cofirmOk",query:{createTime:e.res.createTime,orderCode:e.res.orderCode}})):(s.isDisable=!1,o()("积分已禁用，请联系客服处理",e.optShortDesc))}).catch(function(t){s.isDisable=!1,console.log(t)})}}},p={render:function(){var s=this,t=s.$createElement,e=s._self._c||t;return e("div",{staticStyle:{"padding-bottom":"100px"}},[e("Header",{attrs:{title:"确认兑换"}}),s._v(" "),e("div",{staticClass:"my-content order-detail"},[e("div",{staticClass:"address-wrapper"},[""!=s.selectAddressList?e("div",{staticClass:"address-info",staticStyle:{"margin-bottom":"10px"},on:{click:s.selectAddress}},[e("i",{staticClass:"iconfont add-icon"},[s._v("")]),s._v(" "),e("div",{staticClass:"add-contact"},[e("h5",{staticClass:"clearfix"},[e("span",{staticClass:"contact-name"},[s._v(s._s(s.selectAddressList.shopTact))]),s._v(" "),e("span",{staticClass:"contact-tel"},[s._v(s._s(s.selectAddressList.shopTel))])]),s._v(" "),e("p",{staticClass:"address"},[s._v("收货地址："+s._s(s.selectAddressList.province)+s._s(s.selectAddressList.city)+s._s(s.selectAddressList.address))])]),s._v(" "),s._m(0)]):e("div",{staticClass:"address-info",staticStyle:{"margin-bottom":"10px"},on:{click:s.selectAddress}},[e("i",{staticClass:"iconfont add-icon"},[s._v("")]),s._v(" "),s.shopInfo.shopTact&&s.shopInfo.shopTel?e("div",{staticClass:"add-contact"},[e("h5",{staticClass:"clearfix"},[e("span",{staticClass:"contact-name"},[s._v(s._s(s.shopInfo.shopTact))]),s._v(" "),e("span",{staticClass:"contact-tel"},[s._v(s._s(s.shopInfo.shopTel))])]),s._v(" "),e("p",{staticClass:"address"},[s._v("收货地址："+s._s(s.shopInfo.province)+s._s(s.shopInfo.city)+s._s(s.shopInfo.address))])]):e("div",{staticClass:"add-contact",staticStyle:{height:"36px"}},[s._v("\n                    请编辑收货地址\n                ")]),s._v(" "),s._m(1)])]),s._v(" "),e("mt-cell",{attrs:{title:"礼品清单"}},[e("span",{staticStyle:{color:"#eb6000"}},[s._v("总数："+s._s(s.integralsCount))])]),s._v(" "),e("ul",{staticClass:"mui-table-view goods-list"},s._l(s.salesorders,function(t,i){return e("li",{key:i,staticClass:"mui-table-view-cell"},[e("div",{staticClass:"food-link"},[e("img",{directives:[{name:"lazy",rawName:"v-lazy",value:s.baseurl+t.picUrl,expression:"baseurl+food.picUrl"}]}),s._v(" "),e("div",{staticClass:"recommend"},[e("h4",{staticClass:"skuName"},[s._v(s._s(t.skuName))]),s._v(" "),e("span",{staticClass:"price",staticStyle:{height:"auto"}},[s._v(s._s(t.points)+"积分")]),s._v(" "),e("p",{staticClass:"styleno"},[s._v(s._s(t.explain))]),s._v(" "),e("span",{staticClass:"blue"},[s._v("×"+s._s(t.value))])])])])}),0),s._v(" "),e("div",{staticClass:"form-wrapper mt-10"},[e("mt-cell",{attrs:{title:"兑换总积分"}},[e("span",{staticStyle:{color:"#eb6000"}},[s._v(s._s(s.totalPoints))])]),s._v(" "),e("mt-field",{staticClass:"my-cell",attrs:{label:"买家留言",placeholder:"请输入留言/备注信息（选填）"},model:{value:s.node,callback:function(t){s.node=t},expression:"node"}})],1),s._v(" "),e("div",{staticClass:"bottom-btn"},[e("button",{staticClass:"def-btn",attrs:{type:"button",disabled:s.isDisable},on:{click:function(t){return t.stopPropagation(),s.submitOrder(t)}}},[s._v("确认兑换")])])],1)],1)},staticRenderFns:[function(){var s=this.$createElement,t=this._self._c||s;return t("div",{staticClass:"address-r"},[t("i",{staticClass:"iconfont you"},[this._v("")])])},function(){var s=this.$createElement,t=this._self._c||s;return t("div",{staticClass:"address-r"},[t("i",{staticClass:"iconfont you"},[this._v("")])])}]};var h=e("VU/8")(l,p,!1,function(s){e("S5qY")},"data-v-631462a8",null);t.default=h.exports}});