webpackJsonp([24],{"4EmJ":function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});i("34+y");var n=i("X+yh"),o=i.n(n),s=i("NC6I"),a=i.n(s),r=i("0xDb"),c={name:"Login",components:{},data:function(){return{account:"",pwd:"",openid:"",bindWxShow:!1}},created:function(){var t=Object(r.e)("code");Object(r.i)()&&this.getOpenIdByCode(t)},methods:{getOpenIdByCode:function(t){var e=this,i={code:t};this.$post("/wx/getOpenIdByCode.do",i).then(function(t){var i=JSON.parse(t);"yes"==i.optFlag?(e.$store.commit("setOpenId",i.res.openid),e.openid=i.res.openid,e.wxLogin(i.res.openid)):(o()(i.optDesc),setTimeout(function(){e.$router.push({path:"/login"})},2e3))})},back:function(){this.$router.push({path:"/login"})},CalcuMD5:function(t){return t=a()(t)},register:function(){var t=Object(r.d)();this.$router.push({path:"register",query:{pcid:t}})},wxLogin:function(t){var e=this,i="Android";i=navigator.userAgent.indexOf("Android")>-1||navigator.userAgent.indexOf("Linux")>-1?"android":"iPhone";var n="{'openid':'"+t+"','deviceOS':'wx'}";this.$post("/appAccount/wxLogin.do",{content:n,version:"kkllo",deviceOS:i,login_token:this.$store.getters.logintoken}).then(function(t){var i=JSON.parse(t);if("yes"==i.optFlag){e.$store.commit("setData",i.res);var n=i.res.company,s=i.res.account;i.res.shop;e.$store.commit("setpcid",parseFloat(n.id));var a=s.id?s.id:"",r=e.$route.query.redirect;if("1"!=s.role)return o()("您不是注册客户"),e.$store.commit("loginOut"),!1;i.res.isFirstLogin?e.$router.push({path:"/accountEdit",query:{firstFlag:1}}):r?e.$router.replace(r):window.location.href=location.origin+"/?pcid="+n.id+"&shareId="+a}else"-2"==i.optCode?e.bindWxShow=!0:(o()(i.optDesc),e.bindWxShow=!0)})},bindWxLogin:function(){var t=this;if(""==this.account)return o()({message:"请输入您的账号",duration:1e3}),!1;if(""==this.pwd)return o()({message:"请输入您的密码",duration:1e3}),!1;var e="Android",i=this.CalcuMD5(this.CalcuMD5(this.pwd));e=navigator.userAgent.indexOf("Android")>-1||navigator.userAgent.indexOf("Linux")>-1?"android":"iPhone";var n="{'account':'"+this.account+"','pwd':'"+i+"','deviceOS':'wx','openid':'"+this.openid+"'}";this.$post("/appAccount/wxBindAccount.do",{content:n,version:"kkllo",deviceOS:e,login_token:this.$store.getters.logintoken}).then(function(e){var i=JSON.parse(e);if("yes"==i.optFlag){t.$store.commit("setData",i.res);var n=i.res.company,s=i.res.account;i.res.shop;t.$store.commit("setpcid",parseFloat(n.id));var a=s.id?s.id:"",r=t.$route.query.redirect;if("1"!=s.role)return o()("您不是注册客户"),t.$store.commit("loginOut"),!1;i.res.isFirstLogin?t.$router.push({path:"/accountEdit",query:{firstFlag:1}}):r?t.$router.replace(r):window.location.href=location.origin+"/?pcid="+n.id+"&shareId="+a}else o()(i.optDesc)})}}},d={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{directives:[{name:"show",rawName:"v-show",value:t.bindWxShow,expression:"bindWxShow"}],staticClass:"login"},[i("header",{staticClass:"mint-header"},[i("div",{staticClass:"mint-header-button is-left",on:{click:t.back}},[t._m(0)])]),t._v(" "),i("div",{staticClass:"login-box"},[t._m(1),t._v(" "),i("div",{staticClass:"login-group"},[i("h5",{staticClass:"login-tip"},[t._v("绑定良之隆账号，下次微信一键登录")]),t._v(" "),i("form",{attrs:{action:"",autocomplete:"on"}},[i("div",{staticClass:"input-item"},[t._m(2),t._v(" "),i("span",{staticClass:"pie"},[t._v("|")]),t._v(" "),i("input",{directives:[{name:"model",rawName:"v-model",value:t.account,expression:"account"}],attrs:{type:"text",placeholder:"请输入您的账号/手机号",autocomplete:"on"},domProps:{value:t.account},on:{input:function(e){e.target.composing||(t.account=e.target.value)}}})]),t._v(" "),i("div",{staticClass:"input-item"},[t._m(3),t._v(" "),i("span",{staticClass:"pie"},[t._v("|")]),t._v(" "),i("input",{directives:[{name:"model",rawName:"v-model",value:t.pwd,expression:"pwd"}],attrs:{type:"password",placeholder:"请输入登录密码",autocomplete:"on"},domProps:{value:t.pwd},on:{input:function(e){e.target.composing||(t.pwd=e.target.value)}}})]),t._v(" "),i("button",{staticClass:"login-btn",attrs:{type:"button",size:"large"},on:{click:t.bindWxLogin}},[t._v("\n                    立即绑定\n                ")])]),t._v(" "),i("div",{staticClass:"login-bg"}),t._v(" "),i("div",{staticClass:"link-box"},[i("a",{staticClass:"link",staticStyle:{"margin-right":"0"},attrs:{href:"javascript:;"},on:{click:t.register}},[t._v("还没有账号? 先去注册"),i("span",{staticClass:"iconfont",staticStyle:{"font-size":"10px",color:"#eb6000"}},[t._v("")])])])])])])},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("button",{staticClass:"mint-button mint-button--default mint-button--normal"},[e("span",{staticClass:"mint-button-icon"},[e("i",{staticClass:"mintui mintui-back"})]),this._v(" "),e("label",{staticClass:"mint-button-text"})])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"login-logo"},[e("img",{attrs:{src:i("7Otq"),alt:""}})])},function(){var t=this.$createElement,e=this._self._c||t;return e("label",{attrs:{for:""}},[e("i",{staticClass:"icon iconfont"},[this._v("")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("label",{attrs:{for:""}},[e("i",{staticClass:"icon iconfont"},[this._v("")])])}]};var u=i("VU/8")(c,d,!1,function(t){i("OyLL")},"data-v-bff77c9a",null);e.default=u.exports},OyLL:function(t,e){}});