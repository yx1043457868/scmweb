webpackJsonp([61],{aWK8:function(t,a){},mjO3:function(t,a,i){"use strict";Object.defineProperty(a,"__esModule",{value:!0});i("PBmY");var e=i("I4Nl"),s=i.n(e),n=i("teIl"),c=i("0xDb"),l={name:"activitylist",components:{Header:n.a},data:function(){return{activiteStart:[],activing:[],activitend:[],flag1:!1,flag2:!1,flag3:!1,isShow:!0}},created:function(){this.activeList(),this.changDate1(),this.init()},methods:{activeList:function(){var t=this,a=this.$store.getters.account?this.$store.getters.account:{},i="{'companyId':'"+a.companyId+"','shopId':'"+a.shopId+"'}";this.$post("/activity/customerActivityList.do",{content:i,version:"kkllo",login_token:this.$store.getters.logintoken}).then(function(a){var i=JSON.parse(a);if("yes"==i.optFlag){var e=i.res;e&&e.map(function(a,i){var e=new Date;if(Object(c.a)(a.start_time)>e)return t.activiteStart.push(a)}),e&&e.map(function(a,i){var e=new Date,s=Object(c.a)(a.start_time),n=Object(c.a)(a.end_time);if(s<e&&e<n)return t.activing.push(a)}),e&&e.map(function(a,i){if(new Date>Object(c.a)(a.end_time))return t.activitend.push(a)})}else s()("数据查询失败")})},addactive:function(t){var a=this;this.isShow=!1;var i=this.$store.getters.account?this.$store.getters.account:{},e="{'activityId':'"+t+"','shopId':'"+i.shopId+"','account':'"+i.account+"'}",n=this;this.$post("/activity/signUpactivity.do",{content:e,version:"kkllo",login_token:this.$store.getters.logintoken}).then(function(t){if("yes"==JSON.parse(t).optFlag){s()({message:"报名成功",duration:1800});var i=setInterval(function(){n.$router.push({path:"/myactivity"}),clearInterval(i)},2e3)}else s()("报名失败，重新试试"),a.isShow=!0})},changDate1:function(t){var a=new Date;return t=t&&t.replace(new RegExp(/-/gm),"/"),new Date(Date.parse(t))>a},init:function(){window.addEventListener("scroll",this.scrollFun)},scrollFun:function(){if(this.$refs.activeTab1){var t=this.$refs.activeTab1.parentNode.offsetTop;window.pageYOffset>=t-42?this.flag1=!0:this.flag1=!1}if(this.$refs.activeTab2){var a=this.$refs.activeTab2.parentNode.offsetTop;window.pageYOffset>=a-71?this.flag2=!0:this.flag2=!1}if(this.$refs.activeTab3){var i=this.$refs.activeTab3.parentNode.offsetTop;window.pageYOffset>=i-120?this.flag3=!0:this.flag3=!1}}},destroyed:function(){window.removeEventListener("scroll",this.scrollFun)}},r={render:function(){var t=this,a=t.$createElement,i=t._self._c||a;return i("div",[i("Header",{attrs:{title:"活动列表"}}),t._v(" "),i("div",{staticStyle:{height:"50px"}}),t._v(" "),t.activing&&t.activing.length>0?i("div",{staticClass:"active-list",attrs:{id:"changflag1"}},[i("a",{attrs:{href:"#changflag1"}},[i("div",{ref:"activeTab1",staticClass:"activeTab",class:t.flag1?"fixed1":""},[i("i"),i("span",[t._v("正在进行")])])]),t._v(" "),t.flag1?i("div",{staticStyle:{height:"38px"}}):t._e(),t._v(" "),i("ul",t._l(t.activing,function(a,e){return i("li",{key:e},[i("router-link",{attrs:{to:{path:"/activitydetail",query:{id:a.id}}}},[i("div",{staticClass:"list-img"},[i("img",{directives:[{name:"lazy",rawName:"v-lazy",value:t.baseurl+a.img_path,expression:"baseurl+item.img_path"}],attrs:{alt:"正在进行"}})]),t._v(" "),i("div",{staticClass:"activecontent clearfix "},[i("p",{staticClass:"list-content"},[t._v(t._s(a.name))]),t._v(" "),i("p",{staticClass:"list-time"},[t._v(t._s(a.start_time)+"——"+t._s(a.end_time))]),t._v(" "),a.signflag?i("div",{staticClass:"apply",staticStyle:{background:"#888"}},[t._v("已报名")]):t.changDate1(a.signups_time)?i("div",{staticClass:"apply",staticStyle:{background:"#888"}},[t._v("未开始报名")]):i("div",{staticClass:"apply",on:{click:function(i){return i.stopPropagation(),i.preventDefault(),t.addactive(a.id)}}},[t._v("立即报名")])])])],1)}),0)]):t._e(),t._v(" "),t.activiteStart&&t.activiteStart.length>0?i("div",{staticClass:"active-list",attrs:{id:"changflag2"}},[i("a",{attrs:{href:"#changflag2"}},[i("div",{ref:"activeTab2",staticClass:"activeTab2",class:t.flag2?t.flag1?"fixed2":"fixed1":""},[i("i"),i("span",[t._v("即将开始")])])]),t._v(" "),t.flag2?i("div",{staticStyle:{height:"38px"}}):t._e(),t._v(" "),i("ul",t._l(t.activiteStart,function(a,e){return i("li",{key:e},[i("router-link",{attrs:{to:{path:"/activitydetail",query:{id:a.id}}}},[i("div",{staticClass:"list-img"},[i("img",{directives:[{name:"lazy",rawName:"v-lazy",value:t.baseurl+a.img_path,expression:"baseurl+item.img_path"}],attrs:{alt:"正在进行"}})]),t._v(" "),i("div",{staticClass:"activecontent clearfix "},[i("p",{staticClass:"list-content"},[t._v(t._s(a.name))]),t._v(" "),i("p",{staticClass:"list-time"},[t._v(t._s(a.start_time)+"——"+t._s(a.end_time))]),t._v(" "),a.signflag?i("div",{staticClass:"apply",staticStyle:{background:"#888"}},[t._v("已报名")]):t.changDate1(a.signups_time)?i("div",{staticClass:"apply",staticStyle:{background:"#888"}},[t._v("未开始报名")]):i("div",{staticClass:"apply",on:{click:function(i){return i.stopPropagation(),i.preventDefault(),t.addactive(a.id)}}},[t._v("立即报名")])])])],1)}),0)]):t._e(),t._v(" "),t.activitend&&t.activitend.length>0?i("div",{staticClass:"active-list",attrs:{id:"changflag3"}},[i("a",{attrs:{href:"#changflag3"}},[i("div",{ref:"activeTab3",staticClass:"activeTab3",class:t.flag3?t.flag2&&t.flag1?"fixed3":t.flag2||t.flag1?"fixed2":"fixed1":""},[i("i"),i("span",[t._v("往期回顾")])])]),t._v(" "),t.flag3?i("div",{staticStyle:{height:"38px"}}):t._e(),t._v(" "),i("ul",t._l(t.activitend,function(a,e){return i("li",{key:e},[i("router-link",{attrs:{to:{path:"/activitydetail",query:{id:a.id}}}},[i("div",{staticClass:"list-img"},[i("img",{directives:[{name:"lazy",rawName:"v-lazy",value:t.baseurl+a.img_path,expression:"baseurl+item.img_path"}],attrs:{alt:"特价专区"}}),t._v(" "),i("div",{staticClass:"activeend"},[t._v("已结束")])]),t._v(" "),i("div",{staticClass:"activecontent"},[i("p",{staticClass:"list-content"},[t._v(t._s(a.name))]),t._v(" "),i("p",{staticClass:"list-time"},[t._v(t._s(a.start_time)+"——"+t._s(a.end_time))])])])],1)}),0)]):t._e(),t._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:!t.isShow,expression:"!isShow"}],staticClass:"mask"})],1)},staticRenderFns:[]};var v=i("C7Lr")(l,r,!1,function(t){i("aWK8")},"data-v-04fd79a1",null);a.default=v.exports}});