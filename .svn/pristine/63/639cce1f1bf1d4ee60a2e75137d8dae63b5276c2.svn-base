webpackJsonp([5],{"9Hxd":function(t,e){},dQsP:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});s("yvAY");var a=s("fc0N"),i=s.n(a),n=(s("PBmY"),s("I4Nl")),o=s.n(n),r=s("/QXl"),l=s("2Un3"),c=s("0xDb"),u=s("lRwf"),p={props:{food:{type:Object}},methods:{addCart:function(t,e){if("N"==e.is_enable)return o()({message:"该商品已下架！",duration:950}),!1;this.food.count?this.food.count++:u.set(this.food,"count",1);var s=this.$store.state.integrals.findIndex(function(t){return t.id==e.id});-1===s||null==s||void 0==s?(e.value=1,e.checked=!0,this.$store.commit("addintegralsCarts",e),o()({message:"加入采购单成功！",duration:950}),this.$emit("addCart",t.target)):(e.checked=!0,this.$store.commit("addintegrals",s),o()({message:"加入采购单成功！",duration:950}),this.$emit("addCart",t.target))},decreaseCart:function(t){this.food.count&&this.food.count--;var e=this.$store.state.carts.findIndex(function(e){return e.id==t.id});-1===e||this.$store.commit("reduce",e)}}},d={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"cartcontrol"},[s("button",{staticClass:"cart-btn",on:{click:function(e){return e.stopPropagation(),e.preventDefault(),t.addCart(e,t.food)}}},[s("i",{staticClass:"iconfont addCart"},[t._v("")])])])},staticRenderFns:[]};var v=s("C7Lr")(p,d,!1,function(t){s("9Hxd")},"data-v-fa817042",null).exports,m=s("4YfN"),f=s.n(m),h=s("2bvH"),g={name:"shopBar",data:function(){return{balls:[{show:!1},{show:!1},{show:!1},{show:!1},{show:!1}],dropBalls:[]}},computed:f()({},Object(h.a)(["integralsCount"]),{disabled:function(){return 0==this.integralsCount}}),methods:{commit:function(){this.$router.push({path:"/cofirmConvert"})},popupVisible:function(){this.$emit("popupOpen")},drop:function(t){for(var e=0;e<this.balls.length;e++){var s=this.balls[e];if(!s.show)return s.show=!0,s.el=t,void this.dropBalls.push(s)}},beforeDrop:function(t){for(var e=this.balls.length;e--;){var s=this.balls[e];if(s.show){var a=s.el.getBoundingClientRect(),i=a.left,n=-(window.innerHeight-a.top-52);t.style.display="",t.style.webkitTransform="translate3d(0,"+n+"px,0)",t.style.transform="translate3d(0,"+n+"px,0)";var o=t.getElementsByClassName("inner-hook")[0];o.style.webkitTransform="translate3d("+i+"px,0,0)",o.style.transform="translate3d("+i+"px,0,0)"}}},dropping:function(t,e){t.offsetHeight;this.$nextTick(function(){t.style.webkitTransform="translate3d(0,0,0)",t.style.transform="translate3d(0,0,0)";var s=t.getElementsByClassName("inner-hook")[0];s.style.webkitTransform="translate3d(0,0,0)",s.style.transform="translate3d(0,0,0)",t.addEventListener("transitionend",e)})},afterDrop:function(t){var e=this.dropBalls.shift();e&&(e.show=!1,t.style.display="none")}}},C={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("footer",{staticClass:"shop_cart"},[s("div",{staticClass:"gwcInfo",class:[t.integralsCount>0?"fill":""],on:{click:function(e){return e.stopPropagation(),t.popupVisible(e)}}},[s("i",{directives:[{name:"show",rawName:"v-show",value:t.integralsCount>0,expression:"integralsCount>0"}]},[t._v(t._s(t.integralsCount))])]),t._v(" "),s("button",{attrs:{type:"button",disabled:t.disabled},on:{click:t.commit}},[t._v("兑换礼品")])]),t._v(" "),s("div",{staticClass:"ball-container"},t._l(t.balls,function(e,a){return s("div",{key:a},[s("transition",{attrs:{name:"drop"},on:{"before-enter":t.beforeDrop,enter:t.dropping,"after-enter":t.afterDrop}},[s("div",{directives:[{name:"show",rawName:"v-show",value:e.show,expression:"ball.show"}],staticClass:"ball"},[s("div",{staticClass:"inner inner-hook"})])])],1)}),0)])},staticRenderFns:[]};var _=s("C7Lr")(g,C,!1,function(t){s("wGb2")},"data-v-382d0a0a",null).exports,b=s("teIl"),w=s("2nmU"),k={name:"integralList",components:{Header:b.a,emptyBox:w.a,interBar:_,intercartcontrol:v,MescrollVue:l.a},data:function(){return{shopName:"",totalPoints:0,ablePoints:0,mescroll:null,mescrollDown:{},mescrollUp:{callback:this.upCallback,page:{num:0,size:4},htmlNodata:'<p class="upwarp-nodata">-- 没有更多了 --</p>',noMoreSize:5,empty:{warpId:"mescroll",icon:"static/images/none.png",tip:"暂无相关数据~"}},popup:!1,pointsmallList:[]}},created:function(){this.getPointsDetailList()},computed:{integrals:function(){return this.$store.state.integrals}},beforeRouteEnter:function(t,e,s){s(function(t){t.$refs.mescroll.beforeRouteEnter()})},beforeRouteLeave:function(t,e,s){this.$refs.mescroll.beforeRouteLeave(),s()},mounted:function(){},watch:{popup:function(){var t=this;this.$nextTick(function(){t.popup&&t._initScroll()})}},methods:{mescrollInit:function(t){this.mescroll=t},getPointsDetailList:function(){var t=this,e='{"shopId":"'+this.$store.getters.account.shopId+'","pageSize": "1","pageNo": "1"}';this.$post("/points/pointsDetailList.do",{content:e,version:"kkllo",login_token:this.$store.getters.logintoken}).then(function(e){var s=JSON.parse(e);"yes"==s.optFlag?(t.totalPoints=s.res.totalPoints?s.res.totalPoints:0,t.ablePoints=s.res.ablePoints?s.res.ablePoints:0,t.shopName=s.res.shopName?s.res.shopName:t.$store.getters.shop.shop_name):(o()(s.optDesc),t.totalPoints=0,t.ablePoints=0,t.shopName=t.$store.getters.shop.shop_name)})},_initScroll:function(){this.sampleCart=new r.a(this.$refs.sampleCart,{click:!0,probeType:3})},upCallback:function(t,e){var s=this;setTimeout(function(){var a='{"pageSize": "'+t.size+'","pageNo": "'+t.num+'"}';s.$post("/points/pointsmallList.do",{content:a,version:"kkllo",login_token:s.$store.getters.logintoken}).then(function(a){var i=JSON.parse(a).res;1===t.num&&(s.pointsmallList=[]),s.pointsmallList=s.pointsmallList.concat(i),s.$nextTick(function(){e.endSuccess(i.length)})}).catch(function(t){e.endErr()})},500)},back:function(){if(window.history.length<=1)return this.$router.push({path:"/"}),!1;this.$router.back(-1)},clear:function(){this.$store.commit("clearintegrals"),this.popup=!1},appear:function(){this.popup=!this.popup},addFood:function(t){this._drop(t)},_drop:function(t){var e=this;this.$nextTick(function(){e.$refs.shopcart.drop(t)})},changeValue:function(t,e,s){var a=s.target.value;-1!=t.value.toString().indexOf(".")&&o()("该商品只能输入整数"),t.value=parseInt(a.toString().replace(/[^\d]+/g,""))||0,Object(c.f)(t.value)&&(o()("礼品数量不能为空"),t.value=1)},addCart:function(t,e){this.$store.commit("addintegrals",e)},decreaseCart:function(t,e){var s=this;1==this.$store.state.integrals[e].value?i.a.confirm("确定删除该礼品?").then(function(t){s.$store.commit("reduceintegrals",e)}).catch(function(){}):this.$store.commit("reduceintegrals",e)}}},$={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticClass:"header-content"},[a("header",{staticClass:"mint-header"},[a("div",{staticClass:"mint-header-button is-left",on:{click:t.back}},[t._m(0)]),t._v(" "),a("h1",{staticClass:"mint-header-title"},[t._v("积分商城")]),t._v(" "),a("div",{staticClass:"mint-header-button is-right"})])]),t._v(" "),a("div",{staticClass:"integral-box"},[a("router-link",{staticClass:"header-info",attrs:{to:"/pointsInfo"}},[a("img",{attrs:{src:s("Z2Ou"),alt:""}}),t._v(" "),a("div",{staticClass:"integral-info"},[a("span",{staticClass:"user-name"},[t._v(t._s(t.shopName))]),t._v(" "),a("span",{staticClass:"user-num"},[t._v("总积分："),a("em",[t._v(t._s(t.totalPoints))])])]),t._v(" "),a("span",{staticClass:"integral-text"},[a("em",[t._v(t._s(t.ablePoints))]),t._v("可用积分"),a("i",{staticClass:"iconfont right"},[t._v("")])])])],1),t._v(" "),a("mescroll-vue",{ref:"mescroll",attrs:{down:t.mescrollDown,up:t.mescrollUp},on:{init:t.mescrollInit}},[a("div",{attrs:{id:"mescroll"}},[a("div",{staticClass:"integral-wrapper"},[a("div",{staticClass:"hot-list"},[a("ul",{staticClass:"productList clearfix"},t._l(t.pointsmallList,function(e,s){return a("li",{key:s},[a("div",[a("div",{staticClass:"list-img"},[a("img",{directives:[{name:"lazy",rawName:"v-lazy",value:t.baseurl+e.picUrl,expression:"baseurl+item.picUrl"}],attrs:{alt:"item.skuName"}})]),t._v(" "),a("div",{staticClass:"goods-info"},[a("h4",{staticClass:"list-name mui-ellipsis"},[t._v(t._s(e.skuName))]),t._v(" "),a("p",{staticClass:"list-size mui-ellipsis"},[t._v(t._s(e.explain))]),t._v(" "),a("em",{staticClass:"list-price"},[a("span",[t._v(t._s(e.points))]),t._v(" "),a("span",{staticClass:"unit"},[t._v("积分")])]),t._v(" "),a("div",{staticClass:"cartcontrol-wrapper"},[a("intercartcontrol",{attrs:{food:e},on:{addCart:t.addFood}})],1)])])])}),0)])])])]),t._v(" "),a("interBar",{ref:"shopcart",on:{popupOpen:t.appear}}),t._v(" "),a("section",{directives:[{name:"show",rawName:"v-show",value:t.popup,expression:"popup"}],staticClass:"dialogMask",attrs:{id:"dialogMask"},on:{click:function(e){t.popup=!1}}}),t._v(" "),a("transition",{attrs:{name:"slide","enter-active-class":"animated slideInUp","leave-active-class":"animated slideOutDown"}},[a("div",{directives:[{name:"show",rawName:"v-show",value:t.popup,expression:"popup"}],staticClass:"dialog-wrapper",attrs:{id:"dialog"}},[a("div",{staticClass:"dialog-box"},[a("div",{staticClass:"popup"},[a("div",{staticClass:"popup-header"},[a("span",[t._v("已选礼品")]),t._v(" "),a("span",{staticClass:"iconfont clearpopup",on:{click:t.clear}},[t._v("清空")])]),t._v(" "),a("div",{ref:"sampleCart",staticClass:"cart-wrapper"},[a("div",[a("ul",t._l(t.integrals,function(e,s){return a("li",{key:s,staticClass:"mui-input-row mui-checkbox mui-left"},[a("label",{staticClass:"sku_name"},[t._v(t._s(e.skuName))]),t._v(" "),a("div",{staticClass:"cartcontrol-wrapper",staticStyle:{right:"25px"}},[a("div",{staticClass:"cartcontrol"},[a("button",{staticClass:"cart-decrease",on:{click:function(a){return a.stopPropagation(),a.preventDefault(),t.decreaseCart(e,s)}}},[t._v("-")]),t._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:e.value,expression:"car.value"}],staticClass:"cart-count",attrs:{type:"number",step:"1",min:"0",id:e.id,onkeyup:"value=value.replace(/[^0-9]/g,'')",onpaste:"value=value.replace(/[^0-9]/g,'')",oncontextmenu:"value=value.replace(/[^0-9]/g,'')"},domProps:{value:e.value},on:{blur:function(a){return t.changeValue(e,s,a)},input:function(s){s.target.composing||t.$set(e,"value",s.target.value)}}}),t._v(" "),a("button",{staticClass:"cart-add",on:{click:function(a){return a.stopPropagation(),a.preventDefault(),t.addCart(e,s)}}},[t._v("+")])])]),t._v(" "),a("em",{staticClass:"uomDefault"},[t._v(t._s(e.uom_default))])])}),0)])])])])])])],1)},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("button",{staticClass:"mint-button mint-button--default mint-button--normal",attrs:{"data-v-a23dccce":""}},[e("span",{staticClass:"mint-button-icon"},[e("i",{staticClass:"mintui mintui-back"})]),this._v(" "),e("label",{staticClass:"mint-button-text"})])}]};var x=s("C7Lr")(k,$,!1,function(t){s("y/5v")},"data-v-db8b6442",null);e.default=x.exports},wGb2:function(t,e){},"y/5v":function(t,e){}});