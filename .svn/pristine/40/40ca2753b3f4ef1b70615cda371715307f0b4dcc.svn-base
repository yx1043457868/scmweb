webpackJsonp([34],{"+/ke":function(t,e){},"0Pz3":function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});s("34+y");var a=s("X+yh"),i=s.n(a),o=(s("OgVB"),s("/Lyv")),n=s.n(o),r=s("p0f0"),c=(s("0xDb"),s("06cO")),l={name:"vpOrderList",components:{MescrollVue:r.a,searchPage:c.a},data:function(){return{searchText:"",search:!1,mescroll:null,mescrollDown:{},mescrollUp:{callback:this.upCallback,page:{num:0,size:10},htmlNodata:'<p class="upwarp-nodata">-- 没有更多了 --</p>',noMoreSize:5,empty:{warpId:"mescroll",icon:"static/images/none.png",tip:"暂无相关数据~"}},classId:this.$route.query.typeId||"",currentIndex:0,popupVisible:!1,dataList:[{name:"全部",value:""},{name:"待接单",value:"10"},{name:"处理中",value:"20"},{name:"已处理",value:"30"},{name:"已取消",value:"70"},{name:"已删除",value:"90"}],orderList:[]}},beforeRouteEnter:function(t,e,s){s(function(t){t.$refs.mescroll.beforeRouteEnter()})},beforeRouteLeave:function(t,e,s){this.$refs.mescroll.beforeRouteLeave(),s()},watch:{popupVisible:function(t){t?this.closeTouch():this.openTouch()}},computed:{orderTitle:function(){return""==this.classId?"兑换订单列表":"10"==this.classId?"待接单订单":"20"==this.classId?"处理中订单":"30"==this.classId?"已处理订单":"70"==this.classId?"已取消订单":"90"==this.classId?"已删除订单":void 0}},methods:{hide:function(){this.search=!1},back:function(){if(window.history.length<=1)return this.$router.push({path:"/"}),!1;this.$router.back(-1)},mescrollInit:function(t){this.mescroll=t},upCallback:function(t,e){var s=this;setTimeout(function(){var a='{"shopId":"'+s.$store.getters.account.shopId+'","selectType":"10","orderCode":"","handleStatus": "'+s.classId+'","pageSize": "'+t.size+'","pageNo": "'+t.num+'"}';s.$post("/points/pointsorderList.do",{content:a,version:"kkllo",login_token:s.$store.getters.logintoken}).then(function(a){var i=JSON.parse(a).res;1===t.num&&(s.orderList=[]),s.orderList=s.orderList.concat(i),s.$nextTick(function(){e.endSuccess(i.length)})}).catch(function(t){e.endErr()})},500)},chosen:function(t,e){this.currentIndex=t,"nopay"==e?(this.classId="",this.payStatus="2"):"pay"==e?(this.classId="",this.payStatus="1"):(this.classId=e,this.payStatus="")},reset:function(){this.currentIndex=0,this.classId="",this.searchText=""},comfirm:function(){this.popupVisible=!1,this.mescroll.resetUpScroll()},handleSearch:function(t){this.search=!1,this.searchText=t,this.comfirm()},closeTouch:function(){document.getElementsByTagName("body")[0].addEventListener("touchmove",this.handler,{passive:!1})},openTouch:function(){document.getElementsByTagName("body")[0].removeEventListener("touchmove",this.handler,{passive:!1})},cancelOrder:function(t,e){var s=this;n.a.confirm("确定取消该订单吗?").then(function(a){var o=s.$store.getters.company.owner,n=s.$store.getters.account.account,r="{'orderCode':'"+t+"','account':'"+n+"','owner':'"+o+"'}";s.$post("/appVpOrder/cancelOrder.do",{content:r,version:"kkllo",login_token:s.$store.getters.logintoken}).then(function(t){var a=JSON.parse(t);"yes"==a.optFlag?(""!=s.classId?s.orderList.splice(e,1):s.orderList[e].handleStatus=4,i()(a.optDesc)):i()(a.optDesc)})}).catch(function(){})}}},u={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("div",{staticClass:"header"},[s("mt-header",{attrs:{title:t.orderTitle}},[s("mt-button",{attrs:{slot:"left",icon:"back"},on:{click:t.back},slot:"left"}),t._v(" "),s("mt-button",{attrs:{slot:"right",icon:""},on:{click:function(e){t.popupVisible=!0}},slot:"right"},[s("i",{staticClass:"iconfont",staticStyle:{"font-size":"24px"}},[t._v("")])])],1)],1),t._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:t.popupVisible,expression:"popupVisible"}],staticClass:"mint-popup right-popup mint-popup-right",on:{click:function(e){t.popupVisible=!1}}}),t._v(" "),s("transition",{attrs:{name:"slide","enter-active-class":"animated slideInRight","leave-active-class":"animated slideOutRight"}},[s("div",{directives:[{name:"show",rawName:"v-show",value:t.popupVisible,expression:"popupVisible"}],staticClass:"popup-model"},[s("div",{staticClass:"model-wrap"},[s("div",{staticClass:"model-content"},[s("h5",{staticClass:"model-t"},[s("span",[t._v("订单状态")])]),t._v(" "),s("div",{staticClass:"model-item"},t._l(t.dataList,function(e,a){return s("button",{key:a,class:{active:t.currentIndex===a},on:{click:function(s){t.chosen(a,e.value)}}},[t._v(t._s(e.name))])}),0)])]),t._v(" "),s("div",{staticClass:"handle-btn"},[s("button",{staticClass:"comfirm",on:{click:t.comfirm}},[t._v("确定")])])])]),t._v(" "),s("mescroll-vue",{ref:"mescroll",attrs:{down:t.mescrollDown,up:t.mescrollUp},on:{init:t.mescrollInit}},[s("div",{attrs:{id:"mescroll"}},[s("div",{staticClass:"order-wrapper"},[s("ul",t._l(t.orderList,function(e,a){return s("li",{key:a,staticClass:"order-list"},[s("div",{staticClass:"list-h clearfix"},[s("span",{staticClass:"mui-pull-left",staticStyle:{"font-weight":"500"}},[s("span",{staticClass:"iconfont def"},[t._v("")]),t._v(t._s(e.orderCode))]),t._v(" "),s("span",{staticClass:"orderSt mui-pull-right"},[10==e.handleStatus?s("em",{staticClass:"blue"},[t._v("待接单")]):20==e.handleStatus?s("em",{staticClass:"blue"},[t._v("处理中")]):30==e.handleStatus?s("em",{staticClass:"green"},[t._v("已处理")]):70==e.handleStatus?s("em",{staticClass:"gray"},[t._v("已取消")]):90==e.handleStatus?s("em",{staticClass:"gray"},[t._v("已删除")]):t._e()])]),t._v(" "),s("router-link",{staticClass:"order-info clearfix",attrs:{tag:"div",to:{path:"/pointsOrderDetail",query:{id:e.orderCode}}}},[s("div",{staticClass:"order-img clearfix"},[t._l(e.skuList,function(e,a){return s("img",{directives:[{name:"lazy",rawName:"v-lazy",value:t.baseurl+e.picUrl,expression:"baseurl+order.picUrl"}],key:a,attrs:{alt:""}})}),t._v(" "),1==e.skuList.length?s("h4",{staticClass:"order-title"},[t._v(t._s(e.skuList[0].skuName?e.skuList[0].skuName:"暂无"))]):t._e()],2),t._v(" "),s("i",{staticClass:"iconfont you"},[t._v("")]),t._v(" "),s("p",{staticClass:"order-time"},[t._v("兑换时间："+t._s(e.createTime))]),t._v(" "),s("div",{staticClass:"order-r"},[t._v("共"+t._s(e.totalNum)+"件礼品，兑换："),s("em",[t._v(t._s(e.totalPoints))]),t._v(" 积分 ")])])],1)}),0)])])]),t._v(" "),s("searchPage",{directives:[{name:"show",rawName:"v-show",value:t.search,expression:"search"}],attrs:{placeholder:"请输入订单号/客户名称/客户账号"},on:{hide:t.hide,handleSearch:t.handleSearch}})],1)},staticRenderFns:[]};var d=s("VU/8")(l,u,!1,function(t){s("+/ke")},"data-v-74b4d696",null);e.default=d.exports}});