webpackJsonp([13],{"6jQg":function(t,e){},fz7R:function(t,e){},oeiq:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});n("OgVB");var o=n("/Lyv"),s=n.n(o),a=(n("34+y"),n("X+yh")),c=n.n(a),r=n("teIl"),i={props:{percent:{type:String,default:0}},data:function(){return{}},computed:{}},u={render:function(){var t=this.$createElement,e=this._self._c||t;return e("section",{staticClass:"container"},[e("div",{staticClass:"progress"},[e("span",{staticClass:"blue",style:{width:this.percent}},[e("span",[this._v(this._s(this.percent))])])])])},staticRenderFns:[]};var l=n("VU/8")(i,u,!1,function(t){n("6jQg")},"data-v-45b21560",null).exports,p=n("p0f0"),d=n("0xDb"),f={name:"couponsCenter",components:{MescrollVue:p.a,Header:r.a,progressCircle:l},data:function(){return{mescroll:null,mescrollDown:{},mescrollUp:{callback:this.upCallback,page:{num:0,size:10},htmlNodata:'<p class="upwarp-nodata">-- 没有更多了 --</p>',noMoreSize:5,empty:{warpId:"mescroll",icon:"static/images/none.png",tip:"暂无相关数据~"}},couponsList:[]}},filters:{formatPrice:function(t){return parseFloat(t).toFixed(0)},checkPercent:function(t,e){return parseInt(Object(d.l)(Object(d.k)(t,e),100))+"%"}},beforeRouteEnter:function(t,e,n){n(function(t){t.$refs.mescroll.beforeRouteEnter()})},beforeRouteLeave:function(t,e,n){this.$refs.mescroll.beforeRouteLeave(),n()},methods:{useHandle:function(t){0==t?this.$router.push({path:"/classify"}):this.$router.push({path:"/preorderList"})},receiveCouponHandle:function(t,e,n){var o=this,a=this.$store.getters.account?this.$store.getters.account:"";this.$store.getters.company&&this.$store.getters.company;if(a)if("1"==a.role){var r='{"account": "'+a.account+'","parentId": "'+t+'","couponId": "'+e+'"}';this.$post("/appCounpon/receiveCouponApp.do",{content:r,version:"kkllo",login_token:this.$store.getters.logintoken}).then(function(t){var e=JSON.parse(t);"yes"==e.optFlag?(c()({message:e.optDesc,duration:950}),o.couponsList[n].hasGotten=1,e.receiveCoupon&&(o.receiveCoupon=e.receiveCoupon,o.cardShow=!0)):"no"==e.optFlag&&c()({message:e.optDesc,duration:950})}).catch(function(t){mescroll.endErr()})}else c()({message:"仅微批自营用户可领用",duration:950});else s.a.confirm("请先登录系统").then(function(t){o.$router.push({path:"/login"})}).catch(function(){})},mescrollInit:function(t){this.mescroll=t},upCallback:function(t,e){var n=this,o=this.$route.query.companyId?this.$route.query.companyId:Object(d.d)(),s=this.$route.query.couponId?this.$route.query.couponId:"",a=this.$store.getters.account?this.$store.getters.account:"",c='{"companyId":"'+o+'","account": "'+(a?a.account:"")+'","couponId": "'+s+'","pageSize": "'+t.size+'","pageNo": "'+t.num+'"}';this.$post("/appCounpon/getAllCouponApp.do",{content:c,version:"kkllo",login_token:this.$store.getters.logintoken}).then(function(o){var s=JSON.parse(o).res;1===t.num&&(n.couponsList=[]),n.couponsList=n.couponsList.concat(s),n.$nextTick(function(){e.endSuccess(s.length)})}).catch(function(t){e.endErr()})}}},v={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("Header",{attrs:{title:"领券中心"}}),t._v(" "),n("mescroll-vue",{ref:"mescroll",attrs:{down:t.mescrollDown,up:t.mescrollUp},on:{init:t.mescrollInit}},[n("div",{attrs:{id:"mescroll"}},[n("ul",{staticClass:"card-ul",attrs:{id:"goods-ul"}},t._l(t.couponsList,function(e,o){return n("li",{key:o,staticClass:"card-list"},[n("div",{staticClass:"img-card"},[n("img",{directives:[{name:"lazy",rawName:"v-lazy",value:t.baseurl+e.couponIcon,expression:"baseurl + item.couponIcon"}],attrs:{alt:""}})]),t._v(" "),n("div",{staticClass:"card-center-info"},[n("h4",{staticClass:"card-name"},[t._v(t._s(e.couponName))]),t._v(" "),""!=e.parentId?n("div",{staticClass:"couponInfo"},[n("span",{staticClass:"coupon"},[t._v("卡包套餐")]),n("span",{staticClass:"minMoney"},[t._v(t._s(e.totalCount)+"张优惠券可使用")])]):n("div",{staticClass:"couponInfo"},[n("span",{staticClass:"couponValue"},[t._v(t._s(e.couponValue))]),n("span",{staticClass:"minMoney"},[t._v("满"+t._s(t._f("formatPrice")(e.minMoney))+"可用")])])]),t._v(" "),n("div",{staticClass:"couponRight"},[n("div",{staticClass:"yuan1"}),t._v(" "),n("div",{staticClass:"yuan2"}),t._v(" "),"0"!==e.hasGotten?n("div",{staticClass:"circl"},[n("progress-circle",{attrs:{percent:t._f("checkPercent")(e.gottenCount,e.totalNum)}})],1):n("div",{staticClass:"status get"}),t._v(" "),"0"==e.hasGotten&&e.gottenCount/e.totalNum!=1?n("button",{staticClass:"mui-btn card-btn",on:{click:function(n){t.receiveCouponHandle(e.parentId,e.ID,o)}}},[t._v("立即领取\n                        ")]):"0"==e.hasGotten&&e.gottenCount/e.totalNum==1?n("button",{staticClass:"mui-btn card-btn",attrs:{disabled:""}},[t._v("已抢完\n                        ")]):n("button",{staticClass:"mui-btn card-btn card-use",on:{click:function(n){n.stopPropagation(),t.useHandle(e.yuGou)}}},[t._v("去使用")])])])}),0)])])],1)},staticRenderFns:[]};var h=n("VU/8")(f,v,!1,function(t){n("fz7R")},"data-v-6d57df0a",null);e.default=h.exports}});